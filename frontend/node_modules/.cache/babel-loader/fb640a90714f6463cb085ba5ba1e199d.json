{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\NM adventures V7\\\\frontend\\\\src\\\\pages\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { getChatMessages, postChatMessage } from '../services/api';\nimport { useNotifications } from '../contexts/NotificationsContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState('');\n  const [loading, setLoading] = useState(true);\n  const listRef = useRef(null);\n  const navigate = useNavigate();\n  const {\n    add\n  } = useNotifications();\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      try {\n        const res = await getChatMessages();\n        if (!mounted) return;\n        setMessages(res.messages || []);\n      } catch (err) {\n        add('Could not load chat messages', {\n          type: 'error'\n        });\n      } finally {\n        setLoading(false);\n      }\n    }\n    load();\n    const iv = setInterval(load, 3000);\n    return () => {\n      mounted = false;\n      clearInterval(iv);\n    };\n  }, [add]);\n  useEffect(() => {\n    if (listRef.current) {\n      listRef.current.scrollTop = listRef.current.scrollHeight;\n    }\n  }, [messages]);\n  const send = async () => {\n    if (!text.trim()) return;\n    const payload = {\n      text: text.trim()\n    };\n    try {\n      const res = await postChatMessage(payload);\n      setText('');\n      if (res && res.message) {\n        setMessages(prev => prev.concat(res.message));\n      } else {\n        // reload messages if server didn't return message\n        const fresh = await getChatMessages();\n        setMessages(fresh.messages || []);\n      }\n    } catch (err) {\n      add('Failed to send message', {\n        type: 'error'\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brand\",\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"brand-heading\",\n          children: \"Near-me Adventures\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 32\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: 'right'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginRight: 8\n          },\n          onClick: () => navigate('/dashboard'),\n          children: \"Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            localStorage.removeItem('token');\n            navigate('/login');\n          },\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Community Chat\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: '1px solid #ddd',\n        borderRadius: 6,\n        height: 400,\n        overflow: 'auto',\n        padding: 12\n      },\n      ref: listRef,\n      children: loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading messages...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 20\n      }, this) : messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No messages yet. Say hello!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 35\n      }, this) : messages.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: 700\n          },\n          children: m.senderName || m.sender && (m.sender.name || m.sender.email)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#333'\n          },\n          children: m.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: '#888'\n          },\n          children: new Date(m.createdAt).toLocaleString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 17\n        }, this)]\n      }, m._id || m.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: 2,\n        marginTop: 2\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: text,\n        onChange: e => setText(e.target.value),\n        placeholder: \"Write a message...\",\n        style: {\n          flex: 1,\n          padding: '2px 2px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: send,\n        style: {\n          padding: '2px 2px'\n        },\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"5jFaeZWJJsULbIZtbFUSg461yQ8=\", false, function () {\n  return [useNavigate, useNotifications];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useNavigate","getChatMessages","postChatMessage","useNotifications","jsxDEV","_jsxDEV","Chat","_s","messages","setMessages","text","setText","loading","setLoading","listRef","navigate","add","mounted","load","res","err","type","iv","setInterval","clearInterval","current","scrollTop","scrollHeight","send","trim","payload","message","prev","concat","fresh","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","textAlign","marginRight","onClick","localStorage","removeItem","border","borderRadius","height","overflow","padding","ref","length","map","m","marginBottom","fontWeight","senderName","sender","name","email","color","fontSize","Date","createdAt","toLocaleString","_id","id","display","gap","marginTop","value","onChange","e","target","placeholder","flex","_c","$RefreshReg$"],"sources":["C:/Users/User/Desktop/NM adventures V7/frontend/src/pages/Chat.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { getChatMessages, postChatMessage } from '../services/api';\r\nimport { useNotifications } from '../contexts/NotificationsContext';\r\n\r\nexport default function Chat() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [text, setText] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const listRef = useRef(null);\r\n  const navigate = useNavigate();\r\n  const { add } = useNotifications();\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load() {\r\n      try {\r\n        const res = await getChatMessages();\r\n        if (!mounted) return;\r\n        setMessages(res.messages || []);\r\n      } catch (err) {\r\n        add('Could not load chat messages', { type: 'error' });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    const iv = setInterval(load, 3000);\r\n    return () => { mounted = false; clearInterval(iv); };\r\n  }, [add]);\r\n\r\n  useEffect(() => {\r\n    if (listRef.current) {\r\n      listRef.current.scrollTop = listRef.current.scrollHeight;\r\n    }\r\n  }, [messages]);\r\n\r\n  const send = async () => {\r\n    if (!text.trim()) return;\r\n    const payload = { text: text.trim() };\r\n    try {\r\n      const res = await postChatMessage(payload);\r\n      setText('');\r\n      if (res && res.message) {\r\n        setMessages(prev => prev.concat(res.message));\r\n      } else {\r\n        // reload messages if server didn't return message\r\n        const fresh = await getChatMessages();\r\n        setMessages(fresh.messages || []);\r\n      }\r\n    } catch (err) {\r\n      add('Failed to send message', { type: 'error' });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <div className=\"page-header\">\r\n        <div className=\"brand\"><h2 className=\"brand-heading\">Near-me Adventures</h2></div>\r\n        <div style={{ textAlign: 'right' }}>\r\n          <button style={{ marginRight: 8 }} onClick={() => navigate('/dashboard')}>Back</button>\r\n          <button onClick={() => { localStorage.removeItem('token'); navigate('/login'); }}>Logout</button>\r\n        </div>\r\n      </div>\r\n\r\n      <h1>Community Chat</h1>\r\n\r\n      <div style={{ border: '1px solid #ddd', borderRadius: 6, height: 400, overflow: 'auto', padding: 12 }} ref={listRef}>\r\n        {loading ? <p>Loading messages...</p> : (\r\n          messages.length === 0 ? <p>No messages yet. Say hello!</p> : (\r\n            messages.map(m => (\r\n              <div key={m._id || m.id} style={{ marginBottom: 12 }}>\r\n                <div style={{ fontWeight: 700 }}>{m.senderName || (m.sender && (m.sender.name || m.sender.email))}</div>\r\n                <div style={{ color: '#333' }}>{m.text}</div>\r\n                <div style={{ fontSize: 12, color: '#888' }}>{new Date(m.createdAt).toLocaleString()}</div>\r\n              </div>\r\n            ))\r\n          )\r\n        )}\r\n      </div>\r\n\r\n      <div style={{ display: 'flex', gap: 2, marginTop: 2 }}>\r\n        <input value={text} onChange={e => setText(e.target.value)} placeholder=\"Write a message...\" style={{ flex: 1, padding: '2px 2px' }} />\r\n        <button onClick={send} style={{ padding: '2px 2px' }}>Send</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}