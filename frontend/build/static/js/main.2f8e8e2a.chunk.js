(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],[,,,,function(e,t,s){"use strict";s.r(t),s.d(t,"register",function(){return a}),s.d(t,"login",function(){return r}),s.d(t,"getProfile",function(){return l}),s.d(t,"getAllUsers",function(){return o}),s.d(t,"browseUsers",function(){return d}),s.d(t,"deleteUser",function(){return j}),s.d(t,"getWishlist",function(){return b}),s.d(t,"addWishlist",function(){return u}),s.d(t,"removeWishlist",function(){return h}),s.d(t,"getServerBookings",function(){return m}),s.d(t,"addServerBooking",function(){return O}),s.d(t,"removeServerBooking",function(){return g}),s.d(t,"payBooking",function(){return x}),s.d(t,"getUserBookings",function(){return p}),s.d(t,"getUserWishlist",function(){return v}),s.d(t,"getChatMessages",function(){return f}),s.d(t,"postChatMessage",function(){return y}),s.d(t,"getTrending",function(){return N}),s.d(t,"getAllReviews",function(){return w}),s.d(t,"createReview",function(){return S}),s.d(t,"deleteReview",function(){return k}),s.d(t,"sendConnectionRequest",function(){return C}),s.d(t,"acceptConnectionRequest",function(){return T}),s.d(t,"rejectConnectionRequest",function(){return L}),s.d(t,"cancelConnectionRequest",function(){return R}),s.d(t,"getPendingRequests",function(){return B}),s.d(t,"getSentRequests",function(){return I}),s.d(t,"getFriends",function(){return E}),s.d(t,"removeFriend",function(){return A}),s.d(t,"getConnectionStatus",function(){return P}),s.d(t,"sendDirectMessage",function(){return q}),s.d(t,"getConversation",function(){return F}),s.d(t,"getConversations",function(){return D}),s.d(t,"getUnreadCount",function(){return _}),s.d(t,"markAsRead",function(){return M}),s.d(t,"deleteDirectMessage",function(){return W});var c=s(6);const n="http://localhost:5000/api";async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=t.headers||{},i=localStorage.getItem("token");i&&(s.Authorization="Bearer "+i),s["Content-Type"]=s["Content-Type"]||"application/json";const a=await fetch("".concat(n).concat(e),Object(c.a)(Object(c.a)({},t),{},{headers:s})),r=await a.json().catch(()=>({}));if(!a.ok)throw new Error(r.message||"Request failed");return r}function a(e){return i("/auth/register",{method:"POST",body:JSON.stringify(e)})}function r(e){return i("/auth/login",{method:"POST",body:JSON.stringify(e)})}function l(){return i("/auth/me",{method:"GET"})}function o(){return i("/auth/admin/users",{method:"GET"})}function d(){return i("/auth/users/browse",{method:"GET"})}function j(e){return i("/auth/admin/users/".concat(e),{method:"DELETE"})}function b(){return i("/wishlist",{method:"GET"})}function u(e){return i("/wishlist",{method:"POST",body:JSON.stringify(e)})}function h(e){return i("/wishlist/".concat(e),{method:"DELETE"})}function m(){return i("/bookings",{method:"GET"})}function O(e){return i("/bookings",{method:"POST",body:JSON.stringify(e)})}function g(e){return i("/bookings/".concat(e),{method:"DELETE"})}function x(e){return i("/bookings/".concat(e,"/pay"),{method:"POST"})}function p(e){return i("/auth/admin/users/".concat(e,"/bookings"),{method:"GET"})}function v(e){return i("/auth/admin/users/".concat(e,"/wishlist"),{method:"GET"})}function f(){return i("/chat",{method:"GET"})}function y(e){return i("/chat",{method:"POST",body:JSON.stringify(e)})}function N(){return i("/trending",{method:"GET"})}function w(){return i("/reviews",{method:"GET"})}function S(e){return i("/reviews",{method:"POST",body:JSON.stringify(e)})}function k(e){return i("/reviews/".concat(e),{method:"DELETE"})}function C(e){return i("/connections/send",{method:"POST",body:JSON.stringify({recipientId:e})})}function T(e){return i("/connections/accept/".concat(e),{method:"PUT"})}function L(e){return i("/connections/reject/".concat(e),{method:"PUT"})}function R(e){return i("/connections/cancel/".concat(e),{method:"DELETE"})}function B(){return i("/connections/pending",{method:"GET"})}function I(){return i("/connections/sent",{method:"GET"})}function E(){return i("/connections/friends",{method:"GET"})}function A(e){return i("/connections/friend/".concat(e),{method:"DELETE"})}function P(e){return i("/connections/status/".concat(e),{method:"GET"})}function q(e,t){return i("/direct-messages/send",{method:"POST",body:JSON.stringify({recipientId:e,text:t})})}function F(e){return i("/direct-messages/conversation/".concat(e),{method:"GET"})}function D(){return i("/direct-messages/conversations",{method:"GET"})}function _(){return i("/direct-messages/unread-count",{method:"GET"})}function M(e){return i("/direct-messages/mark-read/".concat(e),{method:"PUT"})}function W(e){return i("/direct-messages/".concat(e),{method:"DELETE"})}},,,function(e,t,s){"use strict";s.r(t),s.d(t,"getBookings",function(){return r}),s.d(t,"saveBookings",function(){return l}),s.d(t,"addBooking",function(){return o}),s.d(t,"removeBooking",function(){return d}),s.d(t,"clearBookings",function(){return j}),s.d(t,"getTotal",function(){return b});var c=s(4);const n="nearme_bookings";function i(){return!!localStorage.getItem("token")}function a(e){if(!e)return 0;const t=String(e).trim();if(/free/i.test(t))return 0;const s=t.replace(/,/g,"").match(/(\d+)/);return s?Number(s[0]):0}function r(){if(i())try{const e=localStorage.getItem(n)||"[]";return JSON.parse(e)}catch(e){return[]}try{const e=localStorage.getItem(n)||"[]";return JSON.parse(e)}catch(e){return[]}}function l(e){localStorage.setItem(n,JSON.stringify(e||[]))}function o(e){if(!e)return;if(i())try{const t=a(e.price),s={itemId:String(e.id),title:e.title,img:e.img,duration:e.duration,price:t,priceLabel:e.price};return Object(c.addServerBooking)(s).then(e=>(l(e.bookings||[]),e.bookings||[])).catch(()=>{const t=r();if(t.find(t=>t.id===e.id))return t;const s=a(e.price),c={id:e.id,title:e.title,price:s,priceLabel:e.price,img:e.img,duration:e.duration};return t.push(c),l(t),t})}catch(o){}if(!e)return;const t=r();if(t.find(t=>t.id===e.id))return t;const s=a(e.price),n={id:e.id,title:e.title,price:s,priceLabel:e.price,img:e.img,duration:e.duration};return t.push(n),l(t),t}function d(e){if(i())return Object(c.removeServerBooking)(String(e)).then(e=>(l(e.bookings||[]),e.bookings||[])).catch(()=>{const t=r().filter(t=>t.id!==e);return l(t),t});const t=r().filter(t=>t.id!==e);return l(t),t}function j(){l([])}function b(){return r().reduce((e,t)=>e+(t.price||0),0)}t.default={getBookings:r,addBooking:o,removeBooking:d,clearBookings:j,getTotal:b}},,function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"a",function(){return r});var c=s(1),n=s(0);const i=Object(c.createContext)(),a=()=>{const e=Object(c.useContext)(i);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e},r=e=>{let{children:t}=e;const[s,a]=Object(c.useState)(()=>localStorage.getItem("theme")||"dark");Object(c.useEffect)(()=>{localStorage.setItem("theme",s),document.documentElement.setAttribute("data-theme",s)},[s]);return Object(n.jsx)(i.Provider,{value:{theme:s,toggleTheme:()=>{a(e=>"dark"===e?"light":"dark")}},children:t})}},,function(e,t,s){},function(e,t,s){},function(e,t,s){},function(e,t,s){"use strict";s.d(t,"a",function(){return K});var c=s(1),n=s.n(c),i=s(3),a=s(6),r=s(5),l=s(4),o=s(0);function d(){const[e,t]=Object(c.useState)({name:"",email:"",password:"",confirm:""}),[s,n]=Object(c.useState)(!1),[d,j]=Object(c.useState)(null),b=Object(i.q)(),u=s=>t(Object(a.a)(Object(a.a)({},e),{},{[s.target.name]:s.target.value}));return Object(o.jsx)("div",{className:"auth-page",children:Object(o.jsxs)("div",{className:"container form-card",children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Near-me Adventures"})}),Object(o.jsx)("h1",{children:"Create an account"}),d&&Object(o.jsx)("p",{className:"msg",style:{color:d.includes("success")?"#16a34a":"#ef4444"},children:d}),Object(o.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),j(null),e.name&&e.email&&e.password)if(e.password.length<4)j("Password must be at least 4 characters");else if(e.password===e.confirm)try{n(!0);const t=await Object(l.register)({name:e.name,email:e.email,password:e.password});localStorage.setItem("token",t.token),localStorage.setItem("userId",t.user.id),b("/home")}catch(s){j(s.message)}finally{n(!1)}else j("Passwords do not match");else j("Please fill all fields")},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Name"}),Object(o.jsx)("input",{name:"name",type:"text",value:e.name,onChange:u})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Email"}),Object(o.jsx)("input",{name:"email",type:"email",value:e.email,onChange:u})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Password"}),Object(o.jsx)("input",{name:"password",type:"password",value:e.password,onChange:u})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Confirm Password"}),Object(o.jsx)("input",{name:"confirm",type:"password",value:e.confirm,onChange:u})]}),Object(o.jsx)("button",{type:"submit",disabled:s,children:s?"Registering...":"Register"})]}),Object(o.jsxs)("div",{className:"small",children:["Already have an account? ",Object(o.jsx)(r.b,{to:"/login",children:"Login"})]})]})})}function j(){const[e,t]=Object(c.useState)({email:"",password:""}),[s,n]=Object(c.useState)(!1),[d,j]=Object(c.useState)(null),b=Object(i.q)(),u=s=>t(Object(a.a)(Object(a.a)({},e),{},{[s.target.name]:s.target.value}));return Object(o.jsx)("div",{className:"auth-page",children:Object(o.jsxs)("div",{className:"container form-card",children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Near-me Adventures"})}),Object(o.jsx)("h1",{children:"Login"}),d&&Object(o.jsx)("p",{className:"msg",style:{color:"#ef4444"},children:d}),Object(o.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),j(null),e.email&&e.password)try{n(!0);const t=await Object(l.login)({email:e.email,password:e.password});localStorage.setItem("token",t.token),localStorage.setItem("userId",t.user.id),b("/home")}catch(s){j(s.message)}finally{n(!1)}else j("Please fill all fields")},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Email"}),Object(o.jsx)("input",{name:"email",type:"email",value:e.email,onChange:u})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Password"}),Object(o.jsx)("input",{name:"password",type:"password",value:e.password,onChange:u})]}),Object(o.jsx)("button",{type:"submit",disabled:s,children:s?"Logging in...":"Login"})]}),Object(o.jsxs)("div",{className:"small",children:["Don't have an account? ",Object(o.jsx)(r.b,{to:"/register",children:"Register"})]}),Object(o.jsxs)("div",{className:"small",style:{marginTop:8},children:["Are you an admin? ",Object(o.jsx)(r.b,{to:"/admin-login",children:"Admin Login"})]}),Object(o.jsx)("br",{}),Object(o.jsxs)("div",{className:"small",style:{marginTop:8},children:["Mail for profile related help-",Object(o.jsx)("br",{}),Object(o.jsx)(r.b,{to:"https://mail.google.com/",children:"nma.admins@gmail.com"})]})]})})}function b(){const[e,t]=Object(c.useState)(null),[s,n]=Object(c.useState)(!0),a=Object(i.q)();return Object(c.useEffect)(()=>{!async function(){try{const e=await Object(l.getProfile)();t(e.user)}catch(e){localStorage.removeItem("token"),a("/login")}finally{n(!1)}}()},[a]),s?Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"Loading..."})}):Object(o.jsxs)("div",{className:"page",children:[Object(o.jsxs)("div",{className:"brand",children:[Object(o.jsx)("h2",{className:"brand-heading",children:"Welcome to Near-me Adventures"}),Object(o.jsxs)("p",{style:{color:"var(--light-gray)",marginTop:"8px"},children:["Your gateway to unforgettable local experiences, ",null===e||void 0===e?void 0:e.name,"!"]})]}),Object(o.jsxs)("div",{style:{marginTop:"32px"},children:[Object(o.jsx)("h3",{style:{color:"var(--soft-ivory)",marginBottom:"16px"},children:"Quick Actions"}),Object(o.jsxs)("div",{className:"home-actions",children:[Object(o.jsx)("div",{className:"action-card",children:Object(o.jsx)(r.b,{to:"/browse",children:Object(o.jsx)("button",{children:"Browse Experiences"})})}),Object(o.jsx)("div",{className:"action-card",children:Object(o.jsx)(r.b,{to:"/trending",children:Object(o.jsx)("button",{children:"Trending Experiences"})})}),Object(o.jsx)("div",{className:"action-card",children:Object(o.jsx)(r.b,{to:"/recommendation",children:Object(o.jsx)("button",{children:"Get Recommendations"})})}),Object(o.jsx)("div",{className:"action-card",children:Object(o.jsx)(r.b,{to:"/reviews",children:Object(o.jsx)("button",{children:"View Reviews"})})})]})]})]})}var u=s(7);function h(e){let{open:t,title:s,message:c,onConfirm:n,onCancel:i}=e;return t?Object(o.jsx)("div",{className:"modal-backdrop",children:Object(o.jsxs)("div",{className:"modal",children:[Object(o.jsx)("h3",{children:s}),Object(o.jsx)("p",{children:c}),Object(o.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[Object(o.jsx)("button",{onClick:i,children:"Cancel"}),Object(o.jsx)("button",{onClick:n,className:"book-button",children:"Confirm"})]})]})}):null}const m=Object(c.createContext)(null);function O(e){let{children:t}=e;const[s,n]=Object(c.useState)([]),i=Object(c.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Date.now()+Math.random(),c={id:s,message:e,type:t.type||"info",timeout:t.timeout||4e3};return n(e=>[c,...e]),c.timeout>0&&setTimeout(()=>{n(e=>e.filter(e=>e.id!==s))},c.timeout),s},[]),a=Object(c.useCallback)(e=>n(t=>t.filter(t=>t.id!==e)),[]);return Object(o.jsxs)(m.Provider,{value:{notes:s,add:i,remove:a},children:[t,Object(o.jsx)("div",{className:"toast-container","aria-live":"polite",children:s.map(e=>Object(o.jsxs)("div",{className:"toast toast-".concat(e.type),children:[Object(o.jsx)("div",{className:"toast-message",children:e.message}),Object(o.jsx)("button",{className:"toast-close",onClick:()=>a(e.id),children:"\xd7"})]},e.id))})]})}function g(){const e=Object(c.useContext)(m);if(!e)throw new Error("useNotifications must be used within NotificationsProvider");return e}function x(){const[e,t]=Object(c.useState)(null),[n,a]=Object(c.useState)(!0),[r,d]=Object(c.useState)([]),[j,b]=Object(c.useState)([]),[m,O]=Object(c.useState)(!0),[x,p]=Object(c.useState)(!0),[v,f]=Object(c.useState)(null),[y,N]=Object(c.useState)(null),w=Object(i.q)(),{add:S}=g();Object(c.useEffect)(()=>{!async function(){try{const e=await Object(l.getProfile)();t(e.user)}catch(e){localStorage.removeItem("token"),w("/login")}finally{a(!1)}}(),d(Object(u.getBookings)())},[w]),Object(c.useEffect)(()=>{let e=!0;return async function(){if(localStorage.getItem("token"))try{const{getServerBookings:c}=await Promise.resolve().then(s.bind(null,4)),{saveBookings:n}=await Promise.resolve().then(s.bind(null,7)),i=await c();if(!e)return;const a=(i.bookings||[]).map(e=>({id:e.itemId||e.id,title:e.title,img:e.img,duration:e.duration,price:e.price,priceLabel:e.priceLabel,paid:!!e.paid,paymentId:e.paymentId}));try{n(a)}catch(t){}d(a)}catch(c){}}(),()=>{e=!1}},[]),Object(c.useEffect)(()=>{let e=!0;return async function(){try{const{getWishlist:t}=await Promise.resolve().then(s.bind(null,4)),c=await t();if(!e)return;b(c.wishlist||[])}catch(t){}}(),()=>{e=!1}},[]);const k=e=>{if(!e)return 0;const t=e.price;if("number"===typeof t)return t;if(!t)return 0;const s=parseFloat(String(t).replace(/[^0-9.]/g,""));return Number.isFinite(s)?s:0};if(n)return Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"Loading..."})});return Object(o.jsxs)("div",{className:"page",children:[Object(o.jsxs)("div",{className:"page-header",children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Near-me Adventures"})}),Object(o.jsxs)("div",{style:{textAlign:"right"},children:[Object(o.jsx)("button",{style:{marginRight:8},onClick:()=>w("/"),children:"Back to Home"}),Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),w("/login")},children:"Logout"})]})]}),Object(o.jsx)("h1",{children:"Your Profile"}),Object(o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Name"}),Object(o.jsx)("div",{children:null===e||void 0===e?void 0:e.name})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Email"}),Object(o.jsx)("div",{children:null===e||void 0===e?void 0:e.email})]})]}),Object(o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:20},children:[Object(o.jsx)("h2",{style:{margin:0},children:"Your Bookings"}),Object(o.jsxs)("div",{children:[Object(o.jsx)("button",{onClick:()=>{const e=!x,t=[...r].sort((t,s)=>{const c=k(t),n=k(s);return e?c-n:n-c});p(e),d(t)},style:{padding:"6px 10px",marginRight:8},children:x?"Price \u2191":"Price \u2193"}),Object(o.jsx)("button",{onClick:()=>w("/payment"),style:{padding:"6px 10px"},children:"Payment"})]})]}),0===r.length?Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"No bookings yet. Browse experiences to add."})}):Object(o.jsx)("div",{className:"grid",style:{marginTop:12},children:r.map(e=>Object(o.jsxs)("div",{className:"card-item",children:[Object(o.jsx)("div",{className:"card-media",style:{backgroundImage:"url(".concat(e.img,")")}}),Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("div",{style:{fontWeight:700},children:e.title}),Object(o.jsx)("div",{className:"muted",children:e.duration}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"muted",children:e.priceLabel?e.priceLabel:"\u09f3 ".concat(e.price)}),Object(o.jsxs)("div",{children:[e.paid?Object(o.jsx)("span",{style:{color:"green",marginRight:8},children:"Paid"}):null,Object(o.jsx)("button",{onClick:()=>(e=>{const t=r.find(t=>t.id===e||t.itemId===e)||{id:e};f(t)})(e.id),children:"Remove"})]})]})})]})]},e.id))}),Object(o.jsx)("div",{style:{marginTop:18},children:Object(o.jsxs)("h3",{children:["Total: ",Object(o.jsxs)("span",{style:{color:"var(--brand-green)"},children:["\u09f3 ",Object(u.getTotal)()]})]})}),Object(o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:20},children:[Object(o.jsx)("h2",{style:{margin:0},children:"Your Wishlist"}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{onClick:()=>{const e=!m,t=[...j].sort((t,s)=>{const c=k(t),n=k(s);return e?c-n:n-c});O(e),b(t)},style:{padding:"6px 10px"},children:m?"Price \u2191":"Price \u2193"})})]}),0===j.length?Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"No saved experiences."})}):Object(o.jsx)("div",{className:"grid",style:{marginTop:12},children:j.map(e=>Object(o.jsxs)("div",{className:"card-item",children:[Object(o.jsx)("div",{className:"card-media",style:{backgroundImage:"url(".concat(e.img,")")}}),Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("div",{style:{fontWeight:700},children:e.title}),Object(o.jsx)("div",{className:"muted",children:e.duration}),Object(o.jsxs)("div",{style:{marginTop:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"muted",children:e.price}),Object(o.jsxs)("div",{children:[Object(o.jsx)("button",{onClick:()=>(async e=>{try{const{removeWishlist:t}=await Promise.resolve().then(s.bind(null,4)),c=await t(e);b(c.wishlist||[]),S("Removed from wishlist",{type:"info"})}catch(t){S("Could not remove from wishlist",{type:"error"})}})(e.itemId),style:{marginRight:8},children:"Remove"}),Object(o.jsx)("button",{onClick:()=>{N(e)},disabled:!!r.find(t=>t.id===e.itemId||t.itemId===e.itemId||t.title===e.title),children:"Book Now"})]})]})]})]},e.itemId))}),Object(o.jsx)(h,{open:!!y,title:"Confirm booking",message:y?'Do you want to book "'.concat(y.title,'" for ').concat(y.price||"","?"):"",onConfirm:()=>{if(y)try{const e={id:y.itemId||y.id||y.title+"|"+y.img,title:y.title,price:y.price,img:y.img,duration:y.duration},t=Object(u.addBooking)({id:e.id,title:e.title,price:e.price,img:e.img,duration:e.duration});t&&"function"===typeof t.then?t.then(e=>d(e)).catch(()=>S("Could not complete booking",{type:"error"})):d(t),S("Booked: ".concat(y.title),{type:"success",timeout:3500})}catch(e){S("Could not complete booking",{type:"error"})}finally{N(null)}},onCancel:()=>N(null)}),Object(o.jsx)(h,{open:!!v,title:"Confirm removal",message:v?'Remove "'.concat(v.title,'" from your bookings?'):"",onConfirm:()=>{if(!v)return;const e=Object(u.removeBooking)(v.id||v.itemId);e&&"function"===typeof e.then?e.then(e=>d(e)).catch(()=>{}):d(e),S("Removed booking: ".concat(v.title),{type:"info"}),f(null)},onCancel:()=>f(null)})]})}function p(){const e=Object(i.q)(),[t,s]=Object(c.useState)(!1),[n,a]=Object(c.useState)(null),[r,d]=Object(c.useState)([]),[j,b]=Object(c.useState)(""),[u,h]=Object(c.useState)("name"),[m,O]=Object(c.useState)(null);return Object(c.useEffect)(()=>{let e=!0;return async function(){s(!0),a(null);try{const t=await Object(l.getAllUsers)();if(!e)return;d(t.users||[])}catch(t){a(t.message)}finally{s(!1)}}(),()=>{e=!1}},[]),Object(o.jsxs)("div",{className:"container",style:{background:"black",color:"white",minHeight:"60vh",padding:20},children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Near-me Adventures"})}),Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,flexDirection:"column"},children:[Object(o.jsx)("button",{onClick:()=>e("/analysis"),style:{padding:"6px 10px"},children:"Analytics"}),Object(o.jsx)("button",{onClick:()=>e("/add-experiences"),style:{padding:"6px 10px",marginTop:8},children:"Experiences Manage (add/view/filter)"}),Object(o.jsx)("button",{onClick:()=>e("/admin/reviews"),style:{padding:"6px 10px",marginTop:8},children:"Reviews Manage"})]}),Object(o.jsx)("h1",{style:{color:"red"},children:"Admin Dashboard"}),Object(o.jsx)("p",{children:"Summary for administrators."}),t&&Object(o.jsx)("p",{children:"Loading users..."}),n&&Object(o.jsx)("p",{style:{color:"crimson"},children:n}),!t&&!n&&Object(o.jsxs)("div",{children:[Object(o.jsxs)("p",{children:[Object(o.jsx)("strong",{children:"Total users:"})," ",r.length]}),Object(o.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[Object(o.jsxs)("select",{value:u,onChange:e=>h(e.target.value),style:{padding:8,borderRadius:8},children:[Object(o.jsx)("option",{value:"name",children:"Name"}),Object(o.jsx)("option",{value:"email",children:"Email"})]}),Object(o.jsx)("input",{placeholder:"email"===u?"Search by email":"Search by name",value:j,onChange:e=>b(e.target.value),style:{padding:8,width:"100%",maxWidth:400,borderRadius:8}}),Object(o.jsx)("button",{onClick:()=>b(""),style:{padding:8,borderRadius:8},children:"Clear"})]}),Object(o.jsx)("div",{style:{overflowX:"auto",marginTop:12},children:Object(o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",color:"white"},children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Name"}),Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Email"}),Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Actions"})]})}),Object(o.jsx)("tbody",{children:r.filter(e=>{if(!j)return!0;const t=j.toLowerCase();return"email"===u?(e.email||"").toLowerCase().includes(t):(e.name||"").toLowerCase().includes(t)}).map(e=>Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:e.name}),Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:e.email}),Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:Object(o.jsx)("button",{onClick:async()=>{if(window.confirm("Delete user ".concat(e.name," (").concat(e.email,")?")))try{O(e._id),await Object(l.deleteUser)(e._id),d(t=>t.filter(t=>t._id!==e._id))}catch(t){alert(t.message||"Delete failed")}finally{O(null)}},disabled:m===e._id,style:{background:"#c0392b",color:"white",border:"none",padding:"6px 10px",cursor:"pointer"},children:m===e._id?"Deleting...":"Delete"})})]},e._id))})]})})]}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),e("/login")},children:"Logout"})})]})}function v(){const[e,t]=Object(c.useState)({email:"",password:""}),[s,n]=Object(c.useState)(null),[l,d]=Object(c.useState)(!1),j=Object(i.q)(),b=s=>t(Object(a.a)(Object(a.a)({},e),{},{[s.target.name]:s.target.value}));return Object(o.jsx)("div",{className:"auth-page",children:Object(o.jsxs)("div",{className:"container form-card",children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Near-me Adventures"})}),Object(o.jsx)("h1",{children:"Admin Login"}),s&&Object(o.jsx)("p",{className:"msg",style:{color:"#ef4444"},children:s}),Object(o.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),n(null),!e.email||!e.password)return n("Please fill all fields");d(!0);try{"admin@gmail.com"===e.email&&"admin123"===e.password?(localStorage.setItem("token","admin-token"),j("/admin")):n("Invalid admin credentials")}finally{d(!1)}},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Email"}),Object(o.jsx)("input",{name:"email",type:"email",value:e.email,onChange:b})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Password"}),Object(o.jsx)("input",{name:"password",type:"password",value:e.password,onChange:b})]}),Object(o.jsx)("button",{type:"submit",disabled:l,children:l?"Logging in...":"Login as Admin"})]}),Object(o.jsxs)("div",{className:"small",children:["Back to ",Object(o.jsx)(r.b,{to:"/login",children:"User Login"})]})]})})}function f(e){let{id:t,img:i,title:a,desc:r,duration:d,price:j,rating:b}=e;const[m,O]=Object(c.useState)(!1),[x,p]=Object(c.useState)(!1);n.a.useEffect(()=>{let e=!0;const c=localStorage.getItem("token");return async function(){try{if(c){const{getServerBookings:c}=await Promise.resolve().then(s.bind(null,4)),n=await c();if(!e)return;const i=n.bookings||[];return void(i.find(e=>e.itemId===String(t)||e.itemId===String(a)||e.id===t)&&O(!0))}}catch(n){}Object(u.getBookings)().find(e=>e.title===a||e.id===t||e.itemId===String(t))&&e&&O(!0)}(),()=>{e=!1}},[a,t]),Object(c.useEffect)(()=>{let e=!0;return async function(){try{const s=await Object(l.getWishlist)();if(!e)return;const c=s.wishlist||[];c.find(e=>e.itemId===String(t)||e.title===a)&&p(!0)}catch(s){}}(),()=>{e=!1}},[a]);const{add:v}=g(),[f,y]=Object(c.useState)(!1);return Object(o.jsxs)("div",{className:"card-item",children:[Object(o.jsx)("div",{className:"card-media",style:{backgroundImage:"url(".concat(i,")")}}),Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("div",{className:"card-title",children:a}),Object(o.jsx)("div",{className:"card-desc muted",children:r}),Object(o.jsxs)("div",{style:{marginTop:"auto"},children:[Object(o.jsxs)("div",{className:"card-row",children:[Object(o.jsx)("div",{className:"muted card-meta",children:d}),Object(o.jsx)("div",{className:"muted card-meta",children:j})]}),Object(o.jsxs)("div",{className:"card-row",style:{marginTop:8},children:[Object(o.jsxs)("div",{className:"muted",children:["\u2b50 ",b]}),Object(o.jsxs)("div",{style:{display:"flex",gap:8},children:[Object(o.jsx)("button",{className:"book-button",onClick:()=>{y(!0)},disabled:m,children:m?"Booked":"Book Now"}),Object(o.jsx)("button",{className:"book-button wishlist-button",onClick:async()=>{try{x?(await Object(l.removeWishlist)(String(t)),p(!1),v("Removed from wishlist: ".concat(a),{type:"info"})):(await Object(l.addWishlist)({itemId:String(t),title:a,img:i,duration:d,price:j}),p(!0),v("Saved to wishlist: ".concat(a),{type:"success"}))}catch(e){v("Could not update wishlist",{type:"error"})}},children:x?"Saved":"Save"})]})]})]})]}),Object(o.jsx)(h,{open:f,title:"Confirm booking",message:'Do you want to book "'.concat(a,'" for ').concat(j,"?"),onConfirm:()=>{const e={id:t||a+"|"+i,title:a,price:j,img:i,duration:d};try{const t=Object(u.addBooking)({id:e.id,title:e.title,price:e.priceLabel||e.price,img:e.img,duration:e.duration});t&&"function"===typeof t.then?t.then(()=>O(!0)).catch(()=>v("Could not complete booking",{type:"error"})):O(!0),v("Booked: ".concat(a),{type:"success",timeout:3500})}catch(s){v("Could not complete booking",{type:"error"})}finally{y(!1)}},onCancel:()=>y(!1)})]})}var y=[{id:1,title:"Ahsan Manzil (Pink Palace)",desc:"A beautifully restored Mughal-style palace museum by the Buriganga River.",duration:"1\u20132 hours",price:"Free",rating:4.6,img:"https://upload.wikimedia.org/wikipedia/commons/1/16/Ahsan_Manzil-Front_View.jpg"},{id:2,title:"Lalbagh Fort",desc:"A historic 17th-century Mughal fortress featuring gardens and gateways.",duration:"1-3 hours",price:"\u09f3 20",rating:4.5,img:"https://images.pexels.com/photos/17830385/pexels-photo-17830385.jpeg"},{id:3,title:"Shilpakala Academy",desc:"A vibrant cultural center hosting theatre, dance and art exhibitions.",duration:"2 hours",price:"\u09f3 300",rating:4.7,img:"https://upload.wikimedia.org/wikipedia/commons/b/b5/Dhaka_Art_Summit_2023.jpg"},{id:4,title:"Prana Yoga Studio",desc:"Boutique yoga studio offering Vinyasa flow classes and workshops.",duration:"1 hours",price:"\u09f3 1200",rating:4.7,img:"https://images.pexels.com/photos/1051838/pexels-photo-1051838.jpeg"},{id:5,title:"Cooking Class",desc:"Hands-on Bengali cooking class teaching biryani, bhorta and sweets.",duration:"3 hours",price:"\u09f3 1200",rating:4.6,img:"https://images.pexels.com/photos/2284166/pexels-photo-2284166.jpeg"},{id:6,title:"Purbachal Cycling Trail",desc:"A scenic lakeside cycling route with smooth paths and fresh air.",duration:"1 hours",price:"Free",rating:4.5,img:"https://images.pexels.com/photos/35100311/pexels-photo-35100311.jpeg"}];function N(){Object(i.q)();const[e,t]=Object(c.useState)(!0),s=e=>{if(!e)return 0;const t=String(e).trim();if(/free/i.test(t))return 0;const s=t.replace(/,/g,"").replace(/[^0-9.\-\u2013]/g," ").match(/(\d+[\d\.]*)/);return s?Number(s[0]):0},n=Object(c.useMemo)(()=>y.slice().sort((t,c)=>{const n=s(t.price),i=s(c.price);return e?n-i:i-n}),[e]);return Object(o.jsxs)("div",{className:"page",children:[Object(o.jsx)("div",{className:"page-header",children:Object(o.jsxs)("div",{className:"brand",children:[Object(o.jsx)("h2",{className:"brand-heading",children:"Browse Experiences"}),Object(o.jsx)("h4",{style:{color:"var(--light-gray)",fontWeight:400},children:"Discover unique activities around you (Premium and best ones)"})]})}),Object(o.jsx)("div",{className:"search-row",children:Object(o.jsx)("button",{onClick:()=>t(e=>!e),style:{padding:"8px 10px",borderRadius:8},children:e?"Price \u2191":"Price \u2193"})}),Object(o.jsx)("div",{className:"grid",children:n.length>0?n.map(e=>Object(o.jsx)(f,Object(a.a)({},e),e.id)):Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"No experiences found."})})})]})}const w="all_places";function S(){const e=Object(i.q)(),[t,s]=Object(c.useState)(0),[n,r]=Object(c.useState)(""),[l,d]=Object(c.useState)("title"),[j,b]=Object(c.useState)(!0),u=Object(c.useMemo)(()=>{try{const e=localStorage.getItem(w)||"[]";return JSON.parse(e)}catch(e){return[]}},[t]),h=[...y,...u],m=e=>{if(!e)return 0;const t=String(e).trim();if(/free/i.test(t))return 0;const s=t.replace(/,/g,"").replace(/[^0-9.\-\u2013]/g," ").match(/(\d+[\d\.]*)/);return s?Number(s[0]):0},O=Object(c.useMemo)(()=>{const e=n.trim().toLowerCase();let t=h.slice();return e&&(t=t.filter(t=>{if("duration"===l)return(t.duration||"").toLowerCase().includes(e);if("price"===l){if(/^\d+(?:\.\d+)?$/.test(e)){const s=Number(e),c=m(t.price);return Number.isFinite(c)&&c<=s}return String(m(t.price)).toLowerCase().includes(e)||(t.price||"").toLowerCase().includes(e)}return(t.title||"").toLowerCase().includes(e)})),t.sort((e,t)=>{const s=m(e.price),c=m(t.price);return j?s-c:c-s})},[h,n,l,j]);return Object(o.jsxs)("div",{className:"page",children:[Object(o.jsxs)("div",{className:"page-header",children:[Object(o.jsxs)("div",{className:"brand",children:[Object(o.jsx)("h2",{className:"brand-heading",children:"All Places"}),Object(o.jsx)("p",{children:"Explore all available places and experiences"})]}),Object(o.jsxs)("div",{style:{textAlign:"right"},children:[Object(o.jsx)("button",{onClick:()=>e(-1),children:"Back"}),Object(o.jsx)("button",{style:{marginLeft:2},onClick:()=>e("/dashboard"),children:"User's Dashboard"})]})]}),Object(o.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[Object(o.jsxs)("select",{value:l,onChange:e=>d(e.target.value),style:{padding:8,borderRadius:8},children:[Object(o.jsx)("option",{value:"title",children:"Title"}),Object(o.jsx)("option",{value:"duration",children:"Duration"}),Object(o.jsx)("option",{value:"price",children:"Price"})]}),Object(o.jsx)("input",{placeholder:"price"===l?"Search by price":"duration"===l?"Search by duration":"Search by title",value:n,onChange:e=>r(e.target.value),style:{padding:8,width:"100%",maxWidth:400,borderRadius:8}}),Object(o.jsx)("button",{onClick:()=>r(""),style:{padding:8,borderRadius:8},children:"Clear"}),Object(o.jsx)("button",{onClick:()=>b(e=>!e),style:{marginLeft:8,padding:"8px 10px",borderRadius:8},children:j?"Price \u2191":"Price \u2193"})]}),Object(o.jsx)("div",{className:"grid",style:{marginTop:12},children:O.length>0?O.map(e=>Object(o.jsx)(f,Object(a.a)({},e),e.id||e._id||e.title)):Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"No places available."})})})]})}function k(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(!1),[a,r]=Object(c.useState)(null),d=Object(i.q)(),[j,b]=Object(c.useState)(""),[u,h]=Object(c.useState)("name");return Object(c.useEffect)(()=>{let e=!0;return async function(){n(!0),r(null);try{const s=await Object(l.getAllUsers)();if(!e)return;t(s.users||[])}catch(s){r(s.message||"Failed to load users")}finally{n(!1)}}(),()=>{e=!1}},[]),Object(o.jsxs)("div",{className:"container admin-container",style:{background:"black",color:"white",minHeight:"60vh",padding:20},children:[Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Analytics"})}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{className:"back-btn",onClick:()=>d("/admin"),children:"Back"})})]}),Object(o.jsx)("h1",{style:{color:"crimson"},children:"Users"}),Object(o.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12,alignItems:"center"},children:[Object(o.jsxs)("select",{value:u,onChange:e=>h(e.target.value),style:{padding:"8px 10px",borderRadius:8},children:[Object(o.jsx)("option",{value:"name",children:"Name"}),Object(o.jsx)("option",{value:"email",children:"Email"})]}),Object(o.jsx)("input",{placeholder:"Search by ".concat(u),value:j,onChange:e=>b(e.target.value),style:{padding:"8px 10px",borderRadius:8,flex:1}}),Object(o.jsx)("button",{onClick:()=>b(""),style:{padding:"8px 10px",borderRadius:8},children:"Clear"})]}),s&&Object(o.jsx)("p",{children:"Loading..."}),a&&Object(o.jsx)("p",{style:{color:"crimson"},children:a}),!s&&!a&&Object(o.jsx)("div",{style:{display:"grid",gap:8},children:e.filter(e=>{if(!j)return!0;const t=j.toLowerCase();return"email"===u?(e.email||"").toLowerCase().includes(t):(e.name||"").toLowerCase().includes(t)}).map(e=>Object(o.jsxs)("button",{className:"admin-btn",onClick:()=>d("/analysis/".concat(e._id)),style:{textAlign:"left",padding:10},children:[e.name," : ",e.email]},e._id))}),Object(o.jsx)("div",{style:{marginTop:16},children:Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),d("/login")},children:"Logout"})})]})}function C(){const{id:e}=Object(i.s)(),t=Object(i.q)(),[s,n]=Object(c.useState)([]),[a,r]=Object(c.useState)([]),[d,j]=Object(c.useState)(!0),[b,u]=Object(c.useState)(null);return Object(c.useEffect)(()=>{let t=!0;return async function(){j(!0),u(null);try{const[s,c]=await Promise.all([Object(l.getUserBookings)(e),Object(l.getUserWishlist)(e)]);if(!t)return;n(s.bookings||[]),r(c.wishlist||[])}catch(s){u(s.message||"Failed to load user data")}finally{j(!1)}}(),()=>{t=!1}},[e]),Object(o.jsxs)("div",{className:"container admin-container",style:{background:"black",color:"white",minHeight:"60vh",padding:20},children:[Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"User Analytics"})}),Object(o.jsxs)("div",{children:[Object(o.jsx)("button",{className:"back-btn",onClick:()=>t("/analysis"),children:"Back"}),Object(o.jsx)("button",{className:"back-btn",onClick:()=>t("/admin"),children:"Admin Dashboard"})]})]}),d&&Object(o.jsx)("p",{children:"Loading user data..."}),b&&Object(o.jsx)("p",{style:{color:"crimson"},children:b}),Object(o.jsx)("h3",{children:"Bookings"}),0===s.length?Object(o.jsx)("p",{children:"No bookings"}):Object(o.jsx)("div",{style:{display:"grid",gap:8},children:s.map(e=>Object(o.jsxs)("div",{style:{border:"1px solid #ddd",padding:8},children:[Object(o.jsx)("div",{style:{fontWeight:700},children:e.title}),Object(o.jsx)("div",{className:"muted",children:e.duration}),Object(o.jsx)("div",{className:"muted",children:e.priceLabel?e.priceLabel:"\u09f3 ".concat(e.price)})]},e.itemId||e.id))}),Object(o.jsx)("h3",{style:{marginTop:16},children:"Wishlist"}),0===a.length?Object(o.jsx)("p",{children:"No wishlist items"}):Object(o.jsx)("div",{style:{display:"grid",gap:8},children:a.map(e=>Object(o.jsxs)("div",{style:{border:"1px solid #ddd",padding:8},children:[Object(o.jsx)("div",{style:{fontWeight:700},children:e.title}),Object(o.jsx)("div",{className:"muted",children:e.duration}),Object(o.jsx)("div",{className:"muted",children:e.price})]},e.itemId))}),Object(o.jsx)("div",{style:{marginTop:16},children:Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),t("/login")},children:"Logout"})})]})}function T(){const[e,t]=Object(c.useState)(!0),[s,n]=Object(c.useState)({topBooked:[],topWishlisted:[]}),a=Object(i.q)();return Object(c.useEffect)(()=>{let e=!0;return async function(){try{const t=await Object(l.getTrending)();e&&n(t)}catch(s){console.error("Failed to load trending:",s)}finally{e&&t(!1)}}(),()=>{e=!1}},[]),e?Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"Loading trending experiences..."})}):Object(o.jsxs)("div",{className:"page",children:[Object(o.jsxs)("div",{className:"page-header",children:[Object(o.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:Object(o.jsx)("h2",{children:"Trending Experiences"})}),Object(o.jsxs)("div",{style:{display:"flex",gap:8},children:[Object(o.jsx)("button",{onClick:()=>a("/home"),children:"Back to Home"}),Object(o.jsx)(r.b,{to:"/browse",children:Object(o.jsx)("button",{children:"Browse Experiences"})})]})]}),Object(o.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:Object(o.jsx)("p",{children:"Discover the most popular experiences right now!!"})}),Object(o.jsxs)("div",{className:"trending-sections",children:[Object(o.jsxs)("div",{className:"trending-column",children:[Object(o.jsx)("h3",{children:"Top 3 Most Booked"}),0===s.topBooked.length&&Object(o.jsx)("div",{className:"muted",children:"No bookings yet"}),s.topBooked.map(e=>Object(o.jsxs)("div",{className:"card small-card",style:{display:"flex",alignItems:"center",gap:12,border:"1px solid #e6e6e6",padding:8,borderRadius:8},children:[e.img?Object(o.jsx)("img",{src:e.img,alt:e.title,style:{width:96,height:64,objectFit:"cover",borderRadius:6}}):Object(o.jsx)("div",{style:{width:96,height:64,background:"#eee",borderRadius:6}}),Object(o.jsx)("div",{style:{flex:1},children:Object(o.jsx)("div",{className:"card-title",children:e.title})}),Object(o.jsxs)("div",{style:{fontWeight:600},className:"muted",children:[e.count," times"]})]},e.itemId))]}),Object(o.jsxs)("div",{className:"trending-column",children:[Object(o.jsx)("h3",{children:"Top 3 Most Wishlisted"}),0===s.topWishlisted.length&&Object(o.jsx)("div",{className:"muted",children:"No wishlists yet"}),s.topWishlisted.map(e=>Object(o.jsxs)("div",{className:"card small-card",style:{display:"flex",alignItems:"center",gap:12,border:"1px solid #e6e6e6",padding:8,borderRadius:8},children:[e.img?Object(o.jsx)("img",{src:e.img,alt:e.title,style:{width:96,height:64,objectFit:"cover",borderRadius:6}}):Object(o.jsx)("div",{style:{width:96,height:64,background:"#eee",borderRadius:6}}),Object(o.jsx)("div",{style:{flex:1},children:Object(o.jsx)("div",{className:"card-title",children:e.title})}),Object(o.jsxs)("div",{style:{fontWeight:600},className:"muted",children:[e.count," users"]})]},e.itemId))]})]})]})}function L(){const e=Object(i.q)(),[t,s]=Object(c.useState)(""),[n,a]=Object(c.useState)(""),[r,l]=Object(c.useState)(""),[d,j]=Object(c.useState)(""),[b,u]=Object(c.useState)(""),[h,m]=Object(c.useState)(0);return Object(o.jsxs)("div",{className:"container admin-container",style:{background:"black",color:"white",minHeight:"60vh",padding:20},children:[Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Add Experiences"})}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{className:"back-btn",onClick:()=>e("/admin"),children:"Back"})})]}),Object(o.jsxs)("form",{onSubmit:e=>{e.preventDefault();const c={id:Date.now(),title:t,desc:n,duration:r,price:d,img:b,rating:Number(h)||0};try{const e=localStorage.getItem("all_places")||"[]",t=JSON.parse(e);t.push(c),localStorage.setItem("all_places",JSON.stringify(t))}catch(e){}alert("Created experience: ".concat(t)),s(""),a(""),l(""),j(""),u(""),m(0)},style:{marginTop:12},children:[Object(o.jsxs)("div",{style:{marginBottom:8},children:[Object(o.jsx)("label",{style:{display:"block",marginBottom:6},children:"Title"}),Object(o.jsx)("input",{value:t,onChange:e=>s(e.target.value),style:{width:"100%",padding:8,borderRadius:8}})]}),Object(o.jsxs)("div",{style:{marginBottom:8},children:[Object(o.jsx)("label",{style:{display:"block",marginBottom:6},children:"Description"}),Object(o.jsx)("textarea",{value:n,onChange:e=>a(e.target.value),style:{width:"100%",padding:8,borderRadius:8}})]}),Object(o.jsx)("div",{style:{display:"flex",gap:8,marginBottom:8},children:Object(o.jsx)("input",{placeholder:"Duration",value:r,onChange:e=>l(e.target.value),style:{flex:1,padding:8,borderRadius:8}})}),Object(o.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[Object(o.jsx)("input",{placeholder:"Price",value:d,onChange:e=>j(e.target.value),style:{flex:1,padding:8,borderRadius:8}}),Object(o.jsx)("input",{placeholder:"Rating",type:"number",min:"0",max:"5",step:"0.1",value:h,onChange:e=>m(e.target.value),style:{flex:1,padding:8,borderRadius:8}})]}),Object(o.jsxs)("div",{style:{marginBottom:8},children:[Object(o.jsx)("label",{style:{display:"block",marginBottom:6},children:"Image URL"}),Object(o.jsx)("input",{value:b,onChange:e=>u(e.target.value),placeholder:"https://...",style:{width:"100%",padding:8,borderRadius:8}})]}),Object(o.jsxs)("div",{style:{display:"flex",gap:8},children:[Object(o.jsx)("button",{type:"submit",style:{background:"var(--brand-green)",color:"white",padding:"8px 12px",borderRadius:8},children:"Create"}),Object(o.jsx)("button",{type:"button",onClick:()=>e("/created-experiences"),style:{padding:"8px 12px",borderRadius:8},children:"View Experiences"})]}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),e("/login")},children:"Logout"})})]})]})}function R(){const e=Object(i.q)(),[t,s]=Object(c.useState)([]),[n,a]=Object(c.useState)(!0),[r,l]=Object(c.useState)(null),[d,j]=Object(c.useState)(""),[b,u]=Object(c.useState)(null);Object(c.useEffect)(()=>{try{a(!0);const e=localStorage.getItem("all_places")||"[]",t=JSON.parse(e);s(Array.isArray(t)?t:[])}catch(e){l(e.message||"Failed to load places")}finally{a(!1)}},[]);const h=t.filter(e=>{if(!d)return!0;const t=d.toLowerCase().trim();if(/^\d+(?:\.\d+)?$/.test(t)){const s=parseFloat(t),c=e.price;let n=null;if("number"===typeof c)n=c;else if("string"===typeof c){const e=c.replace(/,/g,"").match(/(\d+(?:\.\d+)?)/);e&&(n=parseFloat(e[0]))}return null!==n&&Number(n)===Number(s)}return(e.title||"").toLowerCase().includes(t)||(e.duration||"").toLowerCase().includes(t)||(e.price||"").toLowerCase().includes(t)});return Object(o.jsxs)("div",{className:"container admin-container",style:{background:"black",color:"white",minHeight:"60vh",padding:20},children:[Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Created Experiences"})}),Object(o.jsxs)("div",{children:[Object(o.jsx)("button",{className:"back-btn",onClick:()=>e("/add-experiences"),children:"Back"}),Object(o.jsx)("button",{className:"back-btn",onClick:()=>e("/admin"),children:"Admin Dashboard"})]})]}),Object(o.jsx)("p",{children:"Only experiences created via the admin form."}),n&&Object(o.jsx)("p",{children:"Loading..."}),r&&Object(o.jsx)("p",{style:{color:"crimson"},children:r}),!n&&Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[Object(o.jsx)("input",{placeholder:"Search by title, price or duration",value:d,onChange:e=>j(e.target.value),style:{padding:8,width:"100%",maxWidth:400,borderRadius:8}}),Object(o.jsx)("button",{onClick:()=>j(""),style:{padding:8,borderRadius:8},children:"Clear"})]}),Object(o.jsx)("div",{style:{overflowX:"auto",marginTop:12},children:Object(o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",color:"white"},children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Title"}),Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Price"}),Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Duration"}),Object(o.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #444",padding:8},children:"Actions"})]})}),Object(o.jsxs)("tbody",{children:[0===h.length&&Object(o.jsx)("tr",{children:Object(o.jsx)("td",{colSpan:4,style:{padding:8},children:"No experiences found."})}),h.map(e=>Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:e.title}),Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:e.price}),Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:e.duration}),Object(o.jsx)("td",{style:{padding:8,borderBottom:"1px solid #222"},children:Object(o.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("Delete experience ".concat(t,"?")))try{u(e);const t=localStorage.getItem("all_places")||"[]",c=JSON.parse(t).filter(t=>t.id!==e&&t._id!==e);localStorage.setItem("all_places",JSON.stringify(c)),s(c)}catch(c){alert(c.message||"Delete failed")}finally{u(null)}})(e.id||e._id,e.title),disabled:b===(e.id||e._id),style:{background:"#c0392b",color:"white",border:"none",padding:"6px 10px",cursor:"pointer"},children:b===(e.id||e._id)?"Deleting...":"Delete"})})]},e.id||e._id))]})]})})]}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),e("/login")},children:"Logout"})})]})}s(22);function B(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(""),[i,a]=Object(c.useState)(!0),r=Object(c.useRef)(null),{add:d}=g();Object(c.useEffect)(()=>{let e=!0;async function s(){try{const s=await Object(l.getChatMessages)();if(!e)return;t(e=>{const t=Array.isArray(e)?e.length:0,c=s.messages||[],n=Array.isArray(c)?c.length:0;if(n>t)try{window.dispatchEvent(new CustomEvent("chat:new-message",{detail:{added:n-t}}))}catch(i){}return c})}catch(s){d("Could not load chat messages",{type:"error"})}finally{a(!1)}}s();const c=setInterval(s,3e3);return()=>{e=!1,clearInterval(c)}},[d]),Object(c.useEffect)(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[e]);const j=async()=>{if(!s.trim())return;const e={text:s.trim()};try{const s=await Object(l.postChatMessage)(e);if(n(""),s&&s.message)t(e=>e.concat(s.message));else{const e=await Object(l.getChatMessages)();t(e.messages||[])}}catch(c){d("Failed to send message",{type:"error"})}};return Object(o.jsxs)("div",{className:"page",children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Community Chat"})}),Object(o.jsx)("p",{style:{textAlign:"center",color:"var(--text-secondary)",marginBottom:"20px"},children:"Connect with fellow adventurers! Share tips, ask questions, and plan your next near-me adventure together."}),Object(o.jsx)("div",{className:"chat-container",ref:r,children:i?Object(o.jsx)("p",{style:{color:"var(--text-primary)"},children:"Loading messages..."}):0===e.length?Object(o.jsx)("p",{style:{color:"var(--text-primary)"},children:"No messages yet. Say hello!"}):e.map(e=>Object(o.jsxs)("div",{className:"chat-message",children:[Object(o.jsx)("div",{className:"chat-message-sender",children:e.senderName||e.sender&&(e.sender.name||e.sender.email)}),Object(o.jsx)("div",{className:"chat-message-text",children:e.text}),Object(o.jsx)("div",{className:"chat-message-time",children:new Date(e.createdAt).toLocaleString()})]},e._id||e.id))}),Object(o.jsxs)("div",{className:"chat-input-container",children:[Object(o.jsx)("input",{className:"chat-input",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&j(),placeholder:"Write a message..."}),Object(o.jsx)("button",{className:"chat-send-button",onClick:j,children:"Send"})]})]})}function I(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(!0),[a,r]=Object(c.useState)(!0),{add:d}=g(),j=Object(i.q)();Object(c.useEffect)(()=>{let e=!0;return async function(){n(!0);try{const n=Object(u.getBookings)()||[];t(n);if(localStorage.getItem("token"))try{const c=((await l.getServerBookings()).bookings||[]).map(e=>({id:e.itemId||e.id,title:e.title,img:e.img,duration:e.duration,price:e.price,priceLabel:e.priceLabel,paid:!!e.paid,paymentId:e.paymentId}));if(!e)return;t(c);try{Object(u.saveBookings)(c)}catch(s){}}catch(c){}}finally{n(!1)}}(),()=>{e=!1}},[]);const b=e=>{if(!e)return 0;const t=e.price;if("number"===typeof t)return t;if(!t)return 0;const s=parseFloat(String(t).replace(/[^0-9.]/g,""));return Number.isFinite(s)?s:0};return s?Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"Loading..."})}):Object(o.jsxs)("div",{className:"page",children:[Object(o.jsxs)("div",{className:"page-header",children:[Object(o.jsx)("div",{className:"brand",children:Object(o.jsx)("h2",{className:"brand-heading",children:"Near-me Adventures"})}),Object(o.jsx)("div",{style:{textAlign:"right"},children:Object(o.jsx)("button",{style:{marginRight:8},onClick:()=>j("/dashboard"),children:"Back"})})]}),Object(o.jsx)("h1",{children:"Payments"}),Object(o.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:Object(o.jsx)("button",{onClick:()=>{const s=!a,c=[...e].sort((e,t)=>{const c=b(e),n=b(t);return s?c-n:n-c});r(s),t(c)},style:{padding:"6px 10px"},children:a?"Price \u2191":"Price \u2193"})}),0===e.length?Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("p",{children:"No booked experiences to pay for."})}):Object(o.jsx)("div",{className:"grid",style:{marginTop:12},children:e.map(e=>Object(o.jsxs)("div",{className:"card-item",children:[Object(o.jsx)("div",{className:"card-media",style:{backgroundImage:"url(".concat(e.img,")")}}),Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("div",{style:{fontWeight:700},children:e.title}),Object(o.jsx)("div",{className:"muted",children:e.duration}),Object(o.jsxs)("div",{style:{marginTop:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("div",{className:"muted",children:e.priceLabel?e.priceLabel:"\u09f3 ".concat(e.price)}),Object(o.jsx)("div",{children:e.paid?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("span",{style:{color:"green",marginRight:8},children:"Paid"}),Object(o.jsx)("button",{onClick:()=>(e=>{try{const c=Object(u.removeBooking)(e);if(c&&"function"===typeof c.then)c.then(e=>{t(e);try{Object(u.saveBookings)(e)}catch(s){}d("Booking marked done",{type:"info"})}).catch(()=>d("Could not remove booking",{type:"error"}));else{t(c);try{Object(u.saveBookings)(c)}catch(s){}d("Booking marked done",{type:"info"})}}catch(c){d("Could not remove booking",{type:"error"})}})(e.id),children:"Mark as done"})]}):Object(o.jsx)("button",{onClick:()=>(async e=>{try{if(!localStorage.getItem("token"))return d("Please login to make payment",{type:"error"});const c=((await l.payBooking(e)).bookings||[]).map(e=>({id:e.itemId||e.id,title:e.title,img:e.img,duration:e.duration,price:e.price,priceLabel:e.priceLabel,paid:!!e.paid,paymentId:e.paymentId}));t(c);try{Object(u.saveBookings)(c)}catch(s){}d("Payment successful",{type:"success"})}catch(c){d("Payment failed",{type:"error"})}})(e.id),children:"Make Payment"})})]})]})]},e.id))})]})}function E(){const e=Object(i.q)(),[t,s]=Object(c.useState)(""),[n,a]=Object(c.useState)("medium"),[r,l]=Object(c.useState)("nature"),[d,j]=Object(c.useState)("moderate"),[b,u]=Object(c.useState)("spicy"),[h,m]=Object(c.useState)("moderate"),[O,g]=Object(c.useState)(null);function x(e){const{activities:t,budget:s,environment:c,pace:n,foodInterest:i,crowd:a}=e,r=t.toLowerCase().split(/[,;|\/]+/).map(e=>e.trim()).filter(Boolean),l={"Adventurous Traveler":0,"Scenic Lover":0,"Foodie Traveler":0,"Heritage & Culture Lover":0,"Quiet & Relaxation Seeker":0,"Budget Traveler":0,"Luxury Traveler":0},o=(e,t)=>e.some(e=>t.some(t=>e.includes(t)));(o(r,["hike","trek","climb","raft","surf","dive","ski","bungee","zip","camp","adventure","trail","explore"])||"fast"===n)&&(l["Adventurous Traveler"]+=3),(o(r,["scenic","view","waterfall","lake","mountain","beach","sunset","sunrise","landscape","valley","river"])||["beach","mountain","nature"].includes(c))&&(l["Scenic Lover"]+=3),o(r,["food","dine","restaurant","cuisine","street","tasting","foodie","eat"])&&(l["Foodie Traveler"]+=3),(o(r,["museum","history","historic","temple","culture","heritage","monument","ruins","church","palace"])||["city","historic","urban"].includes(c))&&(l["Heritage & Culture Lover"]+=3),(o(r,["spa","relax","yoga","retreat","calm","quiet","massage","resort"])||"relaxed"===n||"avoid"===a)&&(l["Quiet & Relaxation Seeker"]+=3),"low"===s&&(l["Budget Traveler"]+=4),"high"===s&&(l["Luxury Traveler"]+=4),"spicy"===i&&(l["Foodie Traveler"]+=3,l["Adventurous Traveler"]+=1),"sweet"===i&&(l["Foodie Traveler"]+=2,l["Scenic Lover"]+=1),"refreshing"===i&&(l["Quiet & Relaxation Seeker"]+=2,l["Scenic Lover"]+=1),"love"===a&&(l["Foodie Traveler"]+=1),"moderate"===n&&(l["Scenic Lover"]+=1),"beach"===c&&(l["Scenic Lover"]+=1,l["Quiet & Relaxation Seeker"]+=1);const d=Object.entries(l).sort((e,t)=>t[1]-e[1]);let j=d[0][0],b=d.find(e=>{let[t]=e;return t!==j})[0];b||(b=Object.keys(l).find(e=>e!==j)||j);let u="".concat({"Adventurous Traveler":"You're an Adventurous Traveler who seeks thrills and new challenges. Pairing adventure with","Scenic Lover":"You're a Scenic Lover who treasures beautiful views and calm moments. Pairing scenery with","Foodie Traveler":"You're a Foodie Traveler who delights in local flavors and culinary discoveries. Pairing food with","Heritage & Culture Lover":"You're a Heritage & Culture Lover who enjoys history and local traditions. Pairing culture with","Quiet & Relaxation Seeker":"You're a Quiet & Relaxation Seeker who values peace and recharge time. Pairing relaxation with","Budget Traveler":"You're a Budget Traveler who loves smart, wallet-friendly adventures. Pairing budget-savvy choices with","Luxury Traveler":"You're a Luxury Traveler who prefers comfort and premium experiences. Pairing luxury with"}[j]," ").concat(b.toLowerCase(),". Go plan an adventure that fits your style \u2014 you deserve it!");if(((h=u)?h.trim().split(/\s+/).filter(Boolean).length:0)>80){const e=u.split(/\s+/).slice(0,80).join(" ");u=e+"..."}var h;return{primary:j,secondary:b,explanation:u}}return Object(o.jsxs)("div",{className:"page",children:[Object(o.jsx)("div",{className:"page-header",children:Object(o.jsx)("h2",{children:"Recommendation For you!!"})}),Object(o.jsx)("p",{children:"Fill in your travel preferences below to get a personalized adventure recommendation."}),Object(o.jsx)("div",{style:{marginTop:8,marginBottom:12,display:"flex",justifyContent:"flex-end"},children:Object(o.jsxs)("div",{style:{display:"flex",gap:8},children:[Object(o.jsx)("button",{onClick:()=>e("/home"),style:{padding:"6px 10px",fontSize:20,lineHeight:1,borderRadius:4},children:"Back"}),Object(o.jsx)("button",{onClick:()=>e("/browse"),style:{padding:"6px 10px",fontSize:20,lineHeight:1,borderRadius:4},children:"Browse"})]})}),Object(o.jsxs)("form",{className:"form",onSubmit:function(e){e.preventDefault();const s=x({activities:t,budget:n,environment:r,pace:d,foodInterest:b,crowd:h});g(s)},style:{maxWidth:720},children:[Object(o.jsx)("label",{children:"Preferred activities (comma separated)"}),Object(o.jsx)("input",{value:t,onChange:e=>s(e.target.value),placeholder:"e.g. hiking, food tasting, museum",style:{width:"100%",padding:10,fontSize:16,marginBottom:12}}),Object(o.jsx)("label",{children:"Budget level"}),Object(o.jsxs)("select",{value:n,onChange:e=>a(e.target.value),style:{width:"100%",padding:10,fontSize:16,marginBottom:12},children:[Object(o.jsx)("option",{value:"low",children:"Low"}),Object(o.jsx)("option",{value:"medium",children:"Medium"}),Object(o.jsx)("option",{value:"high",children:"High"})]}),Object(o.jsx)("label",{children:"Preferred environment"}),Object(o.jsxs)("select",{value:r,onChange:e=>l(e.target.value),style:{width:"100%",padding:10,fontSize:16,marginBottom:12},children:[Object(o.jsx)("option",{value:"nature",children:"Nature"}),Object(o.jsx)("option",{value:"mountain",children:"Mountain"}),Object(o.jsx)("option",{value:"beach",children:"Beach"}),Object(o.jsx)("option",{value:"city",children:"City"}),Object(o.jsx)("option",{value:"rural",children:"Rural"})]}),Object(o.jsx)("label",{children:"Travel pace"}),Object(o.jsxs)("select",{value:d,onChange:e=>j(e.target.value),style:{width:"100%",padding:10,fontSize:16,marginBottom:12},children:[Object(o.jsx)("option",{value:"relaxed",children:"Relaxed"}),Object(o.jsx)("option",{value:"moderate",children:"Moderate"}),Object(o.jsx)("option",{value:"fast",children:"Fast"})]}),Object(o.jsx)("label",{children:"Food interest level"}),Object(o.jsxs)("select",{value:b,onChange:e=>u(e.target.value),style:{width:"100%",padding:10,fontSize:16,marginBottom:12},children:[Object(o.jsx)("option",{value:"spicy",children:"Spicy"}),Object(o.jsx)("option",{value:"sweet",children:"Sweet"}),Object(o.jsx)("option",{value:"refreshing",children:"Refreshing"})]}),Object(o.jsx)("label",{children:"Crowd preference"}),Object(o.jsxs)("select",{value:h,onChange:e=>m(e.target.value),style:{width:"100%",padding:10,fontSize:16,marginBottom:12},children:[Object(o.jsx)("option",{value:"avoid",children:"Avoid crowds"}),Object(o.jsx)("option",{value:"calm",children:"Calm / small groups"}),Object(o.jsx)("option",{value:"moderate",children:"Moderate"}),Object(o.jsx)("option",{value:"love",children:"Love crowds"})]}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsx)("button",{type:"submit",children:"Get Recommendation"})})]}),O&&Object(o.jsxs)("div",{style:{marginTop:20},className:"card",children:[Object(o.jsxs)("h3",{children:["Primary Type: ",O.primary]}),Object(o.jsxs)("h3",{children:["Secondary Type: ",O.secondary]}),Object(o.jsx)("p",{children:O.explanation})]})]})}s(12);function A(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(!0),[a,r]=Object(c.useState)(null),d=Object(i.q)(),j=Object(c.useCallback)(async()=>{try{n(!0),r(null),console.log("\ud83d\udd04 Fetching all reviews...");const e=await Object(l.getAllReviews)();console.log("\u2705 Reviews data received:",e),t(e.reviews||[])}catch(e){console.error("\u274c Error fetching reviews:",e),r(e.message)}finally{n(!1)}},[]);Object(c.useEffect)(()=>{j()},[j]),Object(c.useEffect)(()=>{const e=()=>{j()};return window.addEventListener("reviews:updated",e),()=>window.removeEventListener("reviews:updated",e)},[j]);return Object(o.jsxs)("div",{className:"reviews-container",children:[Object(o.jsxs)("div",{className:"reviews-header",children:[Object(o.jsxs)("div",{className:"reviews-title-section",children:[Object(o.jsx)("h1",{className:"reviews-title",children:"Community Reviews & Feedback"}),Object(o.jsx)("p",{className:"reviews-subtitle",children:"See what other travelers think about their adventures"})]}),Object(o.jsxs)("div",{className:"reviews-actions",children:[Object(o.jsx)("button",{className:"btn-secondary",onClick:()=>d("/home"),children:"\u2190 Back"}),Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),d("/login")},children:"Logout"})]})]}),s&&Object(o.jsxs)("div",{className:"loading-container",children:[Object(o.jsx)("div",{className:"spinner"}),Object(o.jsx)("p",{children:"Loading reviews..."})]}),a&&Object(o.jsxs)("div",{className:"error-container",children:[Object(o.jsxs)("p",{className:"error-message",children:["Error: ",a]}),Object(o.jsx)("button",{onClick:j,className:"btn-retry",children:"Retry"})]}),!s&&!a&&0===e.length&&Object(o.jsxs)("div",{className:"empty-state",children:[Object(o.jsx)("div",{className:"empty-icon",children:"\ud83d\udcdd"}),Object(o.jsx)("h2",{children:"No reviews yet"}),Object(o.jsx)("p",{children:"Be the first to share your travel experience!"}),Object(o.jsx)("button",{className:"btn-primary",onClick:()=>d("/give-review"),children:"Write a Review"})]}),!s&&!a&&e.length>0&&Object(o.jsx)("div",{className:"reviews-grid",children:e.map(e=>{var t,s,c;return Object(o.jsxs)("div",{className:"review-card",children:[Object(o.jsxs)("div",{className:"review-header",children:[Object(o.jsx)("div",{className:"reviewer-info no-avatar",children:Object(o.jsxs)("div",{className:"reviewer-details",children:[Object(o.jsx)("h3",{className:"reviewer-name",children:(null===(t=e.userId)||void 0===t?void 0:t.name)||"Anonymous User"}),e.location&&Object(o.jsx)("p",{className:"reviewer-location",children:e.location}),Object(o.jsx)("p",{className:"review-date",children:(c=e.createdAt,new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})]})}),e.destination&&Object(o.jsx)("span",{className:"destination-badge",children:e.destination})]}),e.rating&&Object(o.jsxs)("div",{className:"review-rating",children:[(s=e.rating,s?Object(o.jsx)("div",{className:"stars",children:[...Array(5)].map((e,t)=>Object(o.jsx)("span",{className:"star ".concat(t<s?"filled":""),children:"\u2605"},t))}):null),Object(o.jsxs)("span",{className:"rating-number",children:[e.rating,"/5"]})]}),e.reviewText&&Object(o.jsx)("p",{className:"review-text",children:e.reviewText}),!e.reviewText&&e.rating&&Object(o.jsxs)("p",{className:"review-text",style:{fontStyle:"italic",color:"#888"},children:["\u2b50 ",e.rating,"-star rating"]})]},e._id)})}),Object(o.jsx)("button",{className:"fab-give-review",title:"Write a review",onClick:()=>d("/give-review"),children:"\u270d\ufe0f"})]})}function P(){const[e,t]=Object(c.useState)({rating:0,reviewText:"",location:""}),[s,n]=Object(c.useState)(null),[r,d]=Object(c.useState)(!0),[j,b]=Object(c.useState)(!1),[u,h]=Object(c.useState)(null),[m,O]=Object(c.useState)(!1),g=Object(i.q)();Object(c.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=await Object(l.getProfile)();n(e.user)}catch(e){h("Failed to load profile: "+e.message)}finally{d(!1)}},p=s=>{const{name:c,value:n}=s.target;t(Object(a.a)(Object(a.a)({},e),{},{[c]:n}))};return r?Object(o.jsx)("div",{className:"give-review-container",children:Object(o.jsxs)("div",{className:"loading-container",children:[Object(o.jsx)("div",{className:"spinner"}),Object(o.jsx)("p",{children:"Loading your profile..."})]})}):Object(o.jsxs)("div",{className:"give-review-container",children:[Object(o.jsx)("button",{className:"btn-back",onClick:()=>g("/reviews"),children:"\u2190 Back to Reviews"}),Object(o.jsxs)("div",{className:"give-review-card",children:[s&&Object(o.jsxs)("div",{className:"user-profile-section",children:[s.profilePicture?Object(o.jsx)("img",{src:s.profilePicture,alt:s.name,className:"user-profile-avatar",onError:e=>{e.target.style.display="none"}}):null,Object(o.jsxs)("div",{className:"user-profile-info",children:[Object(o.jsx)("h2",{className:"user-profile-name",children:s.name}),Object(o.jsx)("p",{className:"user-profile-email",children:s.email})]})]}),Object(o.jsx)("div",{className:"form-divider"}),Object(o.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),h(null),O(!1),e.location&&e.location.trim())if(!e.reviewText.trim()||e.rating)if(e.rating||e.reviewText.trim())try{b(!0),console.log("Submitting review payload",{rating:e.rating||null,reviewText:e.reviewText.trim()||null,location:e.location.trim()}),await Object(l.createReview)({rating:e.rating||null,reviewText:e.reviewText.trim()||null,location:e.location.trim()});try{window.dispatchEvent(new Event("reviews:updated"))}catch(t){}g("/reviews")}catch(c){var s;if(console.error("Failed to submit review",c),c&&c.status)h("Failed to submit review (".concat(c.status,"): ").concat((null===(s=c.body)||void 0===s?void 0:s.message)||JSON.stringify(c.body)));else h(c.message||"Failed to submit review.")}finally{b(!1)}else h("Please provide either a rating or a review");else h("Rating is required when you write a review");else h("Location is required")},className:"review-form",children:[Object(o.jsx)("h1",{className:"form-title",children:"Share Your Travel Experience"}),u&&Object(o.jsxs)("div",{className:"alert alert-error",children:[Object(o.jsx)("span",{className:"alert-icon",children:"\u26a0\ufe0f"}),u]}),m&&Object(o.jsxs)("div",{className:"alert alert-success",children:[Object(o.jsx)("span",{className:"alert-icon",children:"\u2713"}),"Review submitted successfully! Redirecting..."]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{htmlFor:"location",className:"form-label",children:"Location"}),Object(o.jsx)("input",{type:"text",id:"location",name:"location",placeholder:"e.g., Ahsan Manzil, Lalbagh Fort or any location you visited",value:e.location,onChange:p,className:"form-input",required:!0})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsxs)("label",{className:"form-label",children:["Rating",e.reviewText.trim()&&Object(o.jsx)("span",{className:"required-badge",children:"*Required"})]}),Object(o.jsxs)("div",{className:"rating-selector",children:[[1,2,3,4,5].map(s=>Object(o.jsx)("button",{type:"button",className:"rating-star ".concat(e.rating>=s?"active":""),onClick:()=>{return c=s,void t(Object(a.a)(Object(a.a)({},e),{},{rating:c}));var c},title:"".concat(s," Star").concat(1!==s?"s":""),children:"\u2605"},s)),e.rating>0&&Object(o.jsxs)("span",{className:"rating-display",children:[e.rating,"/5 - ",q(e.rating)]})]})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsxs)("label",{htmlFor:"reviewText",className:"form-label",children:["Your Review (Optional)",!e.reviewText&&e.rating&&Object(o.jsx)("span",{className:"optional-note",children:"(Rating only is fine!)"})]}),Object(o.jsx)("textarea",{id:"reviewText",name:"reviewText",placeholder:"Share your thoughts about thislocation or place... (at least 10 characters if provided)",value:e.reviewText,onChange:p,className:"form-textarea",rows:"6"}),e.reviewText&&Object(o.jsxs)("div",{className:"char-count",children:[e.reviewText.length," characters"]})]}),Object(o.jsx)("button",{type:"submit",disabled:j,className:"btn-submit",children:j?"Submitting...":"Submit Review"}),Object(o.jsx)("p",{className:"form-hint",children:"\ud83d\udca1 Tip: Your review helps other travelers make informed decisions. Be honest and constructive!"})]})]})]})}function q(e){return{1:"Poor",2:"Fair",3:"Good",4:"Very Good",5:"Excellent"}[e]||""}function F(){const e=Object(i.q)(),[t,s]=Object(c.useState)([]),[n,a]=Object(c.useState)(!0),[r,d]=Object(c.useState)(null),[j,b]=Object(c.useState)(""),[u,h]=Object(c.useState)(null),m=Object(c.useCallback)(async()=>{a(!0),d(null);try{const e=await Object(l.getAllReviews)();s(e.reviews||[])}catch(e){d(e.message||"Failed to load reviews")}finally{a(!1)}},[]);Object(c.useEffect)(()=>{m()},[m]);const O=t.filter(e=>{var t,s;if(!j)return!0;const c=j.toLowerCase();return((null===(t=e.userId)||void 0===t?void 0:t.name)||"").toLowerCase().includes(c)||((null===(s=e.userId)||void 0===s?void 0:s.email)||"").toLowerCase().includes(c)});return Object(o.jsxs)("div",{className:"container",style:{padding:20,background:"#000",color:"#fff",minHeight:"60vh"},children:[Object(o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(o.jsx)("h2",{children:"Review Management"}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{onClick:()=>e("/admin"),style:{marginRight:8},children:"Back"})})]}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsx)("input",{placeholder:"Search by reviewer name or email",value:j,onChange:e=>b(e.target.value),style:{padding:8,width:"100%",maxWidth:420,borderRadius:6,background:"#0f0f0f",color:"#fff",border:"1px solid #333"}})}),n&&Object(o.jsx)("p",{children:"Loading reviews..."}),r&&Object(o.jsx)("p",{style:{color:"crimson"},children:r}),!n&&!r&&Object(o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8,marginTop:12},children:O.map(e=>{var t,c;return Object(o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,border:"1px solid #222",borderRadius:8,background:"#0b0b0b",color:"#eee"},children:[Object(o.jsxs)("div",{style:{flex:1},children:[Object(o.jsx)("div",{style:{fontWeight:700,color:"#fff"},children:(null===(t=e.userId)||void 0===t?void 0:t.name)||"Anonymous"}),Object(o.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:null===(c=e.userId)||void 0===c?void 0:c.email}),Object(o.jsx)("div",{style:{marginTop:6,color:"#e6e6e6"},children:e.reviewText?e.reviewText.slice(0,240):"Rating: ".concat(e.rating||"N/A")}),Object(o.jsxs)("div",{style:{marginTop:6,fontSize:12,color:"#999"},children:["Location: ",e.location||"\u2014"," \u2022 ",new Date(e.createdAt).toLocaleString()]})]}),Object(o.jsx)("div",{style:{display:"flex",gap:8},children:Object(o.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this review?"))try{h(e),await Object(l.deleteReview)(e),s(t=>t.filter(t=>t._id!==e))}catch(t){alert(t.message||"Delete failed")}finally{h(null)}})(e._id),disabled:u===e._id,style:{background:"#c0392b",color:"white",border:"none",padding:"6px 10px",borderRadius:6},children:u===e._id?"Deleting...":"Delete"})})]},e._id)})}),Object(o.jsx)("div",{style:{marginTop:12},children:Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),e("/login")},children:"Logout"})})]})}function D(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(!0),[i,a]=Object(c.useState)("");Object(c.useEffect)(()=>{r()},[]);const r=async()=>{try{n(!0);const e=await Object(l.getPendingRequests)();t(e.pendingRequests||[]),a("")}catch(e){a(e.message||"Failed to load pending requests")}finally{n(!1)}};return s?Object(o.jsx)("div",{className:"loading",children:"Loading..."}):i?Object(o.jsx)("div",{className:"error",children:i}):Object(o.jsxs)("div",{className:"pending-requests",children:[Object(o.jsxs)("h2",{children:["Pending Connection Requests (",e.length,")"]}),0===e.length?Object(o.jsx)("p",{children:"No pending requests"}):Object(o.jsx)("div",{className:"requests-list",children:e.map(s=>Object(o.jsxs)("div",{className:"request-card",children:[Object(o.jsxs)("div",{className:"user-info",children:[Object(o.jsx)("h3",{children:s.requester.name}),Object(o.jsx)("p",{children:s.requester.email}),Object(o.jsxs)("small",{children:["Sent: ",new Date(s.createdAt).toLocaleDateString()]})]}),Object(o.jsxs)("div",{className:"actions",children:[Object(o.jsx)("button",{className:"btn-accept",onClick:()=>(async s=>{try{await Object(l.acceptConnectionRequest)(s),t(e.filter(e=>e._id!==s))}catch(c){alert(c.message||"Failed to accept request")}})(s._id),children:"Accept"}),Object(o.jsx)("button",{className:"btn-reject",onClick:()=>(async s=>{try{await Object(l.rejectConnectionRequest)(s),t(e.filter(e=>e._id!==s))}catch(c){alert(c.message||"Failed to reject request")}})(s._id),children:"Reject"})]})]},s._id))})]})}function _(){const e=Object(i.q)(),[t,s]=Object(c.useState)([]),[n,a]=Object(c.useState)(!0),[r,d]=Object(c.useState)("");Object(c.useEffect)(()=>{j()},[]);const j=async()=>{try{a(!0);const e=await Object(l.getFriends)();s(e.friends||[]),d("")}catch(e){d(e.message||"Failed to load friends")}finally{a(!1)}};return n?Object(o.jsx)("div",{className:"loading",children:"Loading..."}):r?Object(o.jsx)("div",{className:"error",children:r}):Object(o.jsxs)("div",{className:"friends-list",children:[Object(o.jsxs)("h2",{children:["My Friends (",t.length,")"]}),0===t.length?Object(o.jsx)("p",{children:"No friends yet. Start connecting!"}):Object(o.jsx)("div",{className:"friends-grid",children:t.map(c=>Object(o.jsxs)("div",{className:"friend-card",children:[Object(o.jsxs)("div",{className:"friend-info",children:[Object(o.jsx)("h3",{children:c.name}),Object(o.jsx)("p",{children:c.email})]}),Object(o.jsxs)("div",{className:"friend-actions",children:[Object(o.jsx)("button",{className:"btn-message",onClick:()=>{return t=c._id,void e("/direct-chat/".concat(t));var t},children:"Message"}),Object(o.jsx)("button",{className:"btn-remove",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this friend?"))try{await Object(l.removeFriend)(e),s(t.filter(t=>t._id!==e))}catch(c){alert(c.message||"Failed to remove friend")}})(c._id),children:"Unfriend"})]})]},c._id))})]})}function M(){const[e,t]=Object(c.useState)("friends"),[s,n]=Object(c.useState)([]),[i,a]=Object(c.useState)(!1),r=e=>{t(e),"sent"===e&&(async()=>{try{a(!0);const e=await Object(l.getSentRequests)();n(e.sentRequests||[])}catch(e){console.error("Failed to load sent requests:",e)}finally{a(!1)}})()};return Object(o.jsxs)("div",{className:"connections-page",children:[Object(o.jsxs)("div",{className:"connections-header",children:[Object(o.jsx)("h1",{children:"Connections"}),Object(o.jsxs)("div",{className:"tabs",children:[Object(o.jsx)("button",{className:"friends"===e?"tab active":"tab",onClick:()=>r("friends"),children:"Friends"}),Object(o.jsx)("button",{className:"pending"===e?"tab active":"tab",onClick:()=>r("pending"),children:"Pending Requests"}),Object(o.jsx)("button",{className:"sent"===e?"tab active":"tab",onClick:()=>r("sent"),children:"Sent Requests"})]})]}),Object(o.jsxs)("div",{className:"connections-content",children:["friends"===e&&Object(o.jsx)(_,{}),"pending"===e&&Object(o.jsx)(D,{}),"sent"===e&&Object(o.jsxs)("div",{className:"sent-requests",children:[Object(o.jsxs)("h2",{children:["Sent Requests (",s.length,")"]}),i?Object(o.jsx)("div",{className:"loading",children:"Loading..."}):0===s.length?Object(o.jsx)("p",{children:"No sent requests"}):Object(o.jsx)("div",{className:"requests-list",children:s.map(e=>Object(o.jsxs)("div",{className:"request-card",children:[Object(o.jsxs)("div",{className:"user-info",children:[Object(o.jsx)("h3",{children:e.recipient.name}),Object(o.jsx)("p",{children:e.recipient.email}),Object(o.jsxs)("small",{children:["Sent: ",new Date(e.createdAt).toLocaleDateString()]})]}),Object(o.jsx)("div",{className:"actions",children:Object(o.jsx)("button",{className:"btn-cancel",onClick:()=>(async e=>{try{await Object(l.cancelConnectionRequest)(e),n(s.filter(t=>t._id!==e))}catch(t){alert(t.message||"Failed to cancel request")}})(e._id),children:"Cancel Request"})})]},e._id))})]})]})]})}function W(e){let{otherUserId:t,otherUserName:s}=e;const[n,i]=Object(c.useState)(null),[a,r]=Object(c.useState)(null),[d,j]=Object(c.useState)(!1),[b,u]=Object(c.useState)(!0);Object(c.useEffect)(()=>{h()},[t]);const h=async()=>{try{u(!0);const e=await Object(l.getConnectionStatus)(t);i(e.status),r(e.connectionId),j(e.isRequester)}catch(e){console.error("Failed to load connection status:",e)}finally{u(!1)}},m=async()=>{try{const e=await Object(l.sendConnectionRequest)(t);i("pending"),r(e.connection._id),j(!0)}catch(e){alert(e.message||"Failed to send request")}},O=async()=>{try{await Object(l.cancelConnectionRequest)(a),i("none"),r(null),j(!1)}catch(e){alert(e.message||"Failed to cancel request")}},g=async()=>{try{await Object(l.acceptConnectionRequest)(a),i("accepted")}catch(e){alert(e.message||"Failed to accept request")}},x=async()=>{try{await Object(l.rejectConnectionRequest)(a),i("rejected")}catch(e){alert(e.message||"Failed to reject request")}};return b?Object(o.jsx)("div",{className:"loading-btn",children:"..."}):"none"===n?Object(o.jsx)("button",{className:"btn-connect",onClick:m,children:"Add Friend"}):"pending"===n&&d?Object(o.jsxs)("div",{className:"connection-status",children:[Object(o.jsx)("span",{className:"status-text",children:"Request Sent"}),Object(o.jsx)("button",{className:"btn-cancel",onClick:O,children:"Cancel"})]}):"pending"!==n||d?"accepted"===n?Object(o.jsx)("div",{className:"connection-status",children:Object(o.jsx)("span",{className:"status-friends",children:"\u2713 Friends"})}):"rejected"===n?Object(o.jsx)("div",{className:"connection-status",children:Object(o.jsx)("span",{className:"status-rejected",children:"Request Rejected"})}):null:Object(o.jsxs)("div",{className:"connection-actions",children:[Object(o.jsx)("button",{className:"btn-accept",onClick:g,children:"Accept"}),Object(o.jsx)("button",{className:"btn-reject",onClick:x,children:"Reject"})]})}s(13);function U(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(!0),[i,a]=Object(c.useState)(""),[r,d]=Object(c.useState)("");Object(c.useEffect)(()=>{j()},[]);const j=async()=>{try{n(!0);const e=await Object(l.browseUsers)();t(e.users||[]),a("")}catch(e){a(e.message||"Failed to load users")}finally{n(!1)}},b=e.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())||e.email.toLowerCase().includes(r.toLowerCase()));return s?Object(o.jsx)("div",{className:"loading-container",children:"Loading users..."}):i?Object(o.jsx)("div",{className:"error-container",children:i}):Object(o.jsxs)("div",{className:"find-people-page",children:[Object(o.jsxs)("div",{className:"find-people-header",children:[Object(o.jsx)("h1",{children:"Find People"}),Object(o.jsx)("p",{className:"subtitle",children:"Connect with other travelers and adventurers"})]}),Object(o.jsxs)("div",{className:"search-section",children:[Object(o.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:r,onChange:e=>d(e.target.value),className:"search-input"}),Object(o.jsxs)("span",{className:"search-count",children:[b.length," users found"]})]}),Object(o.jsx)("div",{className:"users-grid",children:0===b.length?Object(o.jsx)("div",{className:"no-users",children:Object(o.jsx)("p",{children:"No users found matching your search."})}):b.map(e=>Object(o.jsxs)("div",{className:"user-card",children:[Object(o.jsx)("div",{className:"user-avatar",children:e.name.charAt(0).toUpperCase()}),Object(o.jsxs)("div",{className:"user-details",children:[Object(o.jsx)("h3",{className:"user-name",children:e.name}),Object(o.jsx)("p",{className:"user-email",children:e.email}),e.createdAt&&Object(o.jsxs)("p",{className:"user-joined",children:["Joined ",new Date(e.createdAt).toLocaleDateString()]})]}),Object(o.jsx)("div",{className:"user-actions",children:Object(o.jsx)(W,{otherUserId:e._id,otherUserName:e.name})})]},e._id))})]})}s(11);function G(){const e=Object(i.q)(),[t,s]=Object(c.useState)([]),[n,a]=Object(c.useState)([]),[r,d]=Object(c.useState)(!0),[j,b]=Object(c.useState)(""),[u,h]=Object(c.useState)("conversations");Object(c.useEffect)(()=>{m();const e=setInterval(m,5e3);return()=>clearInterval(e)},[]);const m=async()=>{try{const[e,t]=await Promise.all([Object(l.getConversations)(),Object(l.getFriends)()]);s(e.conversations||[]),a(t.friends||[]),b("")}catch(e){b(e.message||"Failed to load data")}finally{d(!1)}},O=t=>{e("/direct-chat/".concat(t))};return r?Object(o.jsx)("div",{className:"loading-container",children:"Loading..."}):Object(o.jsxs)("div",{className:"messages-page",children:[Object(o.jsxs)("div",{className:"messages-header",children:[Object(o.jsx)("h1",{children:"Messages"}),Object(o.jsxs)("div",{className:"tabs",children:[Object(o.jsx)("button",{className:"conversations"===u?"tab active":"tab",onClick:()=>h("conversations"),children:"Conversations"}),Object(o.jsx)("button",{className:"friends"===u?"tab active":"tab",onClick:()=>h("friends"),children:"All Friends"})]})]}),j&&Object(o.jsx)("div",{className:"error-message",children:j}),"conversations"===u&&Object(o.jsx)("div",{className:"conversations-list",children:0===t.length?Object(o.jsxs)("div",{className:"no-conversations",children:[Object(o.jsx)("p",{children:"No conversations yet"}),Object(o.jsx)("p",{className:"hint",children:"Start chatting with your friends!"})]}):t.map(e=>Object(o.jsxs)("div",{className:"conversation-item",onClick:()=>O(e.user._id),children:[Object(o.jsx)("div",{className:"conv-avatar",children:e.user.name.charAt(0).toUpperCase()}),Object(o.jsxs)("div",{className:"conv-details",children:[Object(o.jsxs)("div",{className:"conv-header",children:[Object(o.jsx)("h3",{children:e.user.name}),Object(o.jsx)("span",{className:"conv-time",children:new Date(e.lastMessageTime).toLocaleDateString()})]}),Object(o.jsx)("p",{className:"conv-last-message",children:e.lastMessage})]}),e.unreadCount>0&&Object(o.jsx)("span",{className:"unread-badge",children:e.unreadCount})]},e.user._id))}),"friends"===u&&Object(o.jsx)("div",{className:"friends-list",children:0===n.length?Object(o.jsxs)("div",{className:"no-friends",children:[Object(o.jsx)("p",{children:"No friends yet"}),Object(o.jsx)("p",{className:"hint",children:"Add friends to start messaging!"})]}):n.map(e=>Object(o.jsxs)("div",{className:"friend-item",onClick:()=>O(e._id),children:[Object(o.jsx)("div",{className:"friend-avatar",children:e.name.charAt(0).toUpperCase()}),Object(o.jsxs)("div",{className:"friend-details",children:[Object(o.jsx)("h3",{children:e.name}),Object(o.jsx)("p",{children:e.email})]}),Object(o.jsx)("button",{className:"chat-button",children:"Chat"})]},e._id))})]})}function J(){var e;const{userId:t}=Object(i.s)(),s=Object(i.q)(),[n,a]=Object(c.useState)([]),[r,d]=Object(c.useState)(""),[j,b]=Object(c.useState)(!0),[u,h]=Object(c.useState)(!1),[m,O]=Object(c.useState)(""),[g,x]=Object(c.useState)(null),[p,v]=Object(c.useState)(null),f=Object(c.useRef)(null);Object(c.useEffect)(()=>{y()},[]),Object(c.useEffect)(()=>{if(t&&p){w();const e=setInterval(w,3e3);return()=>clearInterval(e)}},[t,p]),Object(c.useEffect)(()=>{N()},[n]);const y=async()=>{try{const e=await Object(l.getProfile)();v(e.user._id)}catch(e){console.error("Failed to load user profile:",e)}},N=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},w=async()=>{try{const e=await Object(l.getConversation)(t);if(a(e.messages||[]),e.messages&&e.messages.length>0){const t=e.messages[0],s=t.sender._id===p?t.recipient:t.sender;x(s)}O(""),b(!1)}catch(e){O(e.message||"Failed to load messages"),b(!1)}},S=async e=>{if(e.preventDefault(),r.trim())try{h(!0),await Object(l.sendDirectMessage)(t,r.trim()),d(""),await w()}catch(s){alert(s.message||"Failed to send message")}finally{h(!1)}};return j||!p?Object(o.jsx)("div",{className:"loading-container",children:"Loading conversation..."}):m?Object(o.jsx)("div",{className:"error-container",children:m}):Object(o.jsxs)("div",{className:"direct-chat-page",children:[Object(o.jsxs)("div",{className:"chat-header",children:[Object(o.jsx)("button",{className:"back-button",onClick:()=>s("/messages"),children:"\u2190 Back"}),Object(o.jsx)("div",{className:"chat-user-info",children:g&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"chat-avatar",children:null===(e=g.name)||void 0===e?void 0:e.charAt(0).toUpperCase()}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{children:g.name}),Object(o.jsx)("p",{className:"user-status",children:"Active"})]})]})})]}),Object(o.jsxs)("div",{className:"messages-container",children:[0===n.length?Object(o.jsx)("div",{className:"no-messages",children:Object(o.jsx)("p",{children:"No messages yet. Start the conversation!"})}):n.map(e=>Object(o.jsx)("div",{className:"message ".concat(e.sender._id===p?"sent":"received"),children:Object(o.jsxs)("div",{className:"message-content",children:[Object(o.jsx)("p",{className:"message-text",children:e.text}),Object(o.jsx)("span",{className:"message-time",children:new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e._id)),Object(o.jsx)("div",{ref:f})]}),Object(o.jsxs)("form",{className:"message-input-form",onSubmit:S,children:[Object(o.jsx)("textarea",{value:r,onChange:e=>d(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),S(e))},placeholder:"Aa",className:"message-input",disabled:u,rows:1}),Object(o.jsx)("button",{type:"submit",className:"send-button",disabled:u||!r.trim(),"aria-label":"Send"})]})]})}function H(e){let{children:t}=e;return localStorage.getItem("token")?t:Object(o.jsx)(i.a,{to:"/login",replace:!0})}var z=s(9);s(23);function Y(e){let{user:t,onToggleSidebar:s,sidebarOpen:c}=e;const n=Object(i.q)(),{theme:a,toggleTheme:l}=Object(z.b)();return Object(o.jsx)("nav",{className:"navbar",children:Object(o.jsxs)("div",{className:"navbar-container",children:[Object(o.jsxs)("div",{className:"navbar-left",children:[Object(o.jsx)("button",{className:"sidebar-toggle",onClick:s,"aria-label":"Toggle sidebar",children:Object(o.jsxs)("span",{className:"hamburger ".concat(c?"open":""),children:[Object(o.jsx)("span",{}),Object(o.jsx)("span",{}),Object(o.jsx)("span",{})]})}),Object(o.jsxs)(r.b,{to:"/home",className:"navbar-brand",children:[Object(o.jsx)("span",{className:"brand-icon",children:"\ud83d\uddfa\ufe0f"}),Object(o.jsx)("span",{className:"brand-text",children:"Near-me Adventures"})]})]}),Object(o.jsxs)("div",{className:"navbar-right",children:[Object(o.jsxs)("button",{className:"theme-toggle",onClick:l,children:[Object(o.jsx)("span",{className:"theme-toggle-icon",children:"dark"===a?"\u2600\ufe0f":"\ud83c\udf19"}),Object(o.jsx)("span",{children:"dark"===a?"Light":"Dark"})]}),t&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"user-info",children:[Object(o.jsx)("span",{className:"user-name",children:t.name}),Object(o.jsx)("span",{className:"user-email",children:t.email})]}),Object(o.jsx)("button",{className:"btn-logout",onClick:()=>{localStorage.removeItem("token"),n("/login")},children:"Logout"})]})]})]})})}s(24);function Q(e){let{isOpen:t,unreadChat:s,pendingConnections:c}=e;const n=[{path:"/home",icon:"\ud83c\udfe0",label:"Home"},{path:"/browse",icon:"\ud83d\udd0d",label:"Browse Experiences"},{path:"/all-places",icon:"\ud83d\udccd",label:"All Places"},{path:"/trending",icon:"\ud83d\udd25",label:"Trending"},{path:"/recommendation",icon:"\u2b50",label:"Recommendations"},{path:"/dashboard",icon:"\ud83d\udcca",label:"Dashboard"},{path:"/find-people",icon:"\ud83d\udd0e",label:"Find People"},{path:"/connections",icon:"\ud83d\udc65",label:"Connections",badge:c},{path:"/messages",icon:"\u2709\ufe0f",label:"Messages"},{path:"/reviews",icon:"\ud83d\udcac",label:"Reviews"},{path:"/chat",icon:"\ud83d\udcad",label:"Chat",badge:s},{path:"/payment",icon:"\ud83d\udcb3",label:"Payment"}];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("aside",{className:"sidebar ".concat(t?"open":""),children:Object(o.jsxs)("div",{className:"sidebar-content",children:[Object(o.jsxs)("div",{className:"sidebar-section",children:[Object(o.jsx)("div",{className:"sidebar-section-title",children:"Main Menu"}),Object(o.jsx)("nav",{className:"sidebar-nav",children:n.map(e=>Object(o.jsxs)(r.c,{to:e.path,className:e=>{let{isActive:t}=e;return"sidebar-link ".concat(t?"active":"")},children:[Object(o.jsx)("span",{className:"sidebar-icon",children:e.icon}),Object(o.jsx)("span",{className:"sidebar-label",children:e.label}),e.badge>0&&Object(o.jsx)("span",{className:"sidebar-badge",children:e.badge})]},e.path))})]}),Object(o.jsxs)("div",{className:"sidebar-section",children:[Object(o.jsx)("div",{className:"sidebar-section-title",children:"Management"}),Object(o.jsx)("nav",{className:"sidebar-nav",children:[{path:"/add-experiences",icon:"\u2795",label:"Add Experience"},{path:"/created-experiences",icon:"\ud83d\udcdd",label:"My Experiences"},{path:"/admin",icon:"\u2699\ufe0f",label:"Admin Dashboard"},{path:"/analysis",icon:"\ud83d\udcc8",label:"Analytics"}].map(e=>Object(o.jsxs)(r.c,{to:e.path,className:e=>{let{isActive:t}=e;return"sidebar-link ".concat(t?"active":"")},children:[Object(o.jsx)("span",{className:"sidebar-icon",children:e.icon}),Object(o.jsx)("span",{className:"sidebar-label",children:e.label})]},e.path))})]})]})}),t&&Object(o.jsx)("div",{className:"sidebar-overlay"})]})}s(25);function V(e){let{children:t}=e;const[s,n]=Object(c.useState)(null),[a,r]=Object(c.useState)(!0),[d,j]=Object(c.useState)(0),[b,u]=Object(c.useState)(0),h=Object(i.q)();Object(c.useEffect)(()=>{!async function(){try{const e=await Object(l.getProfile)();n(e.user)}catch(e){localStorage.removeItem("token"),h("/login")}}()},[h]),Object(c.useEffect)(()=>{async function e(){try{const e=await Object(l.getPendingRequests)();u(e.count||0)}catch(e){console.error("Failed to load pending connections:",e)}}e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]),Object(c.useEffect)(()=>{const e=e=>{var t;const s=(null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.added)||1;j(e=>e+s)};return window.addEventListener("chat:new-message",e),()=>window.removeEventListener("chat:new-message",e)},[]),Object(c.useEffect)(()=>{const e=()=>{u(e=>e+1)};return window.addEventListener("connection:new-request",e),()=>window.removeEventListener("connection:new-request",e)},[]);return Object(o.jsxs)("div",{className:"app-layout",children:[Object(o.jsx)(Y,{user:s,onToggleSidebar:()=>r(!a),sidebarOpen:a}),Object(o.jsx)(Q,{isOpen:a,unreadChat:d,pendingConnections:b}),Object(o.jsx)("main",{className:"main-content ".concat(a?"sidebar-open":"sidebar-closed"),children:t})]})}s(26);function K(){return Object(o.jsx)(O,{children:Object(o.jsxs)(i.d,{children:[Object(o.jsx)(i.b,{path:"/",element:Object(o.jsx)(i.a,{to:"/home",replace:!0})}),Object(o.jsx)(i.b,{path:"/register",element:Object(o.jsx)(d,{})}),Object(o.jsx)(i.b,{path:"/login",element:Object(o.jsx)(j,{})}),Object(o.jsx)(i.b,{path:"/admin-login",element:Object(o.jsx)(v,{})}),Object(o.jsx)(i.b,{path:"/home",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(b,{})})})}),Object(o.jsx)(i.b,{path:"/browse",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(N,{})})})}),Object(o.jsx)(i.b,{path:"/all-places",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(S,{})})})}),Object(o.jsx)(i.b,{path:"/dashboard",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(x,{})})})}),Object(o.jsx)(i.b,{path:"/payment",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(I,{})})})}),Object(o.jsx)(i.b,{path:"/chat",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(B,{})})})}),Object(o.jsx)(i.b,{path:"/trending",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(T,{})})})}),Object(o.jsx)(i.b,{path:"/recommendation",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(E,{})})})}),Object(o.jsx)(i.b,{path:"/admin",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(p,{})})})}),Object(o.jsx)(i.b,{path:"/admin/reviews",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(F,{})})})}),Object(o.jsx)(i.b,{path:"/analysis",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(k,{})})})}),Object(o.jsx)(i.b,{path:"/analysis/:id",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(C,{})})})}),Object(o.jsx)(i.b,{path:"/add-experiences",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(L,{})})})}),Object(o.jsx)(i.b,{path:"/created-experiences",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(R,{})})})}),Object(o.jsx)(i.b,{path:"/reviews",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(A,{})})})}),Object(o.jsx)(i.b,{path:"/give-review",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(P,{})})})}),Object(o.jsx)(i.b,{path:"/connections",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(M,{})})})}),Object(o.jsx)(i.b,{path:"/find-people",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(U,{})})})}),Object(o.jsx)(i.b,{path:"/messages",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(G,{})})})}),Object(o.jsx)(i.b,{path:"/direct-chat/:userId",element:Object(o.jsx)(H,{children:Object(o.jsx)(V,{children:Object(o.jsx)(J,{})})})}),Object(o.jsx)(i.b,{path:"*",element:Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("h2",{children:"Page not found"})})})]})})}},function(e,t,s){"use strict";s.r(t),function(e){var t=s(1),c=s.n(t),n=s(8),i=s.n(n),a=s(5),r=s(14),l=s(9),o=(s(27),s(0));"undefined"===typeof e&&(window.process={env:{}}),i.a.render(Object(o.jsx)(c.a.StrictMode,{children:Object(o.jsx)(l.a,{children:Object(o.jsx)(a.a,{children:Object(o.jsx)(r.a,{})})})}),document.getElementById("root"))}.call(this,s(16))},,,,,,,function(e,t,s){},function(e,t,s){},function(e,t,s){},function(e,t,s){},function(e,t,s){},function(e,t,s){}],[[15,1,2]]]);
//# sourceMappingURL=main.2f8e8e2a.chunk.js.map